---
#-------------------------------
# PostgreSQL
#-------------------------------

- ENTRY:
  EXPLAIN: PostgreSQL vs MySQL
  BODY: |
    - 共通テーブル式（CTE）：SELECT/INSERT/UPDATE/DELETE 内で参照可能な一時的結果セット
    - GIS / SRS：空間データ処理（PostGIS による拡張）、座標系管理
    - JSONB：重複キー除去・空白削除のバイナリ JSON、PostgreSQL の強み
    - MVCC：複数トランザクションの同時アクセスを効率的に処理
    - ウィンドウ関数：行の集合を横断して計算する集計機能
    - 宣言的パーティショニング：テーブル分割による管理性向上（PostgreSQL 10 以降）
    - 論理レプリケーション：挿入/更新/削除イベントに基づくデータ複製
    - 半同期レプリケーション：スレーブ確認を待つコミット（外部ツールで提供する場合あり）
    - ACID 対応：トランザクションの整合性保証（ストレージ依存の差異あり）
    - バックアップとリカバリ：高効率なツール群による復旧運用
    - クロスプラットフォーム：UNIX 系での最適化機能が豊富
    - 拡張性：PostGIS 等の豊富な拡張モジュール
    - 外部キー：参照整合性サポート（ストレージエンジン依存の差あり）
    - 高度なインデックス：GIN / GiST 等の特殊インデックスをサポート
    - データ型：配列 / hstore 等、豊富な型サポート
    - ストアドプロシージャ：PL/pgSQL による高度なルーチン実装
    - トリガ：柔軟なトリガ実装
    - マテリアライズドビュー：計算結果のキャッシュと定期更新による高速アクセス

- ENTRY:
  EXPLAIN: Package
  BODY: |
    ■ Windows

    17 	2022, 2019
    16 	2022, 2019
    15 	2019, 2016
    14 	2019, 2016
    13 	2019, 2016

    ■ Ubuntsu

    postgresql-client-17 	              // client libraries and client binaries
    postgresql-17 	                    // core database server
    postgresql-doc-17 	                // documentation
    libpq-dev 	                        // libraries and headers for C frontend development
    postgresql-server-dev-17 	          // libraries and headers for C backend development

- ENTRY:
  EXPLAIN: Install
  BODY: |
    sudo apt update
    sudo apt install postgresql-17 postgresql-client-17 postgresql-doc-17 libpq-dev postgresql-server-dev-17

    PATH: /usr/local/pgsql/bin/

- ENTRY:
  EXPLAIN: Database 作成と削除
  BODY: |
    ■ DB 作成
    createdb <db_name>
    sudo -u postgres createdb <db_name>
    sudo -u postgres psql -c "CREATE DATABASE <db_name>;"

    ■ 作成サンプル
    CREATE DATABASE <db_name>
      WITH OWNER <owner_name>
      ENCODING 'UTF8'
      TABLESPACE pg_default
      LC_COLLATE 'ja_JP.UTF-8'
      LC_CTYPE 'ja_JP.UTF-8'
      TEMPLATE template0;

    ■ DB 削除
    dropdb <db_name>
    sudo -u postgres dropdb <db_name>
    psql -U postgres -d <db_name> -c "DROP DATABASE <db_name>;"

- ENTRY:
  EXPLAIN: アクセス,バージョン,ヘルプ,終了
  BODY: |
    ■ アクセス
    psql <db_name>
    psql -U <user_name> -d <db_name> -h <host_name> -p <port_number>
    psql -U postgres -d postgres -h localhost -p 5432

      psql (16.4)
      Type "help" for help.
      mydb=>

    ■ バージョン
    mydb=> SELECT version();

    ■ ヘルプ
    mydb=> \h
    mydb=> \h CREATE TABLE

    ■ 終了
    mydb=> \q

- ENTRY:
  EXPLAIN: テーブルの作成と削除
  BODY: |
    ■ テーブル作成
    CREATE TABLE <table_name> (
      index         SERIAL,
      column_name1  integer,
      column_name2  text,
      column_name3  numeric,
    );

    ■ テーブル削除
    DROP TABLE <table_name>;
    DROP TABLE IF EXISTS <table_name>;  // 存在しない場合はエラーを出さない
    DROP TABLE <table_name> RESTRICT;   // 依存するオブジェクトがある場合は削除しない
    DROP TABLE <table_name> CASCADE;    // 依存するオブジェクトも削除

- ENTRY:
  EXPLAIN: テーブルの作成 詳細
  BODY: |
    ■ テーブル作成
    CREATE [ [ GLOBAL | LOCAL ] { TEMPORARY | TEMP } | UNLOGGED ]
    TABLE [ IF NOT EXISTS ] 
    table_name ( [
      { column_name data_type 
        [ STORAGE { PLAIN | EXTERNAL | EXTENDED | MAIN | DEFAULT } ]
        [ COMPRESSION compression_method ]
        [ COLLATE collation ]
        [ 🔵column_constraint [ ... ] ]
        | table_constraint
        | LIKE source_table [ 🟢like_option ... ]
      }
      [, ... ]
    ] )
    [ INHERITS ( parent_table [, ... ] ) ]
    [
      PARTITION BY { RANGE | LIST | HASH } (
        { column_name | ( expression ) }
        [ COLLATE collation ]
        [ opclass ]
        [, ... ]
      )
    ]
    [ USING method ]
    [ WITH ( storage_parameter [= value] [, ... ] ) | WITHOUT OIDS ]
    [ ON COMMIT { PRESERVE ROWS | DELETE ROWS | DROP } ]
    [ TABLESPACE tablespace_name ]

    【🔵column_constraint】
    [ CONSTRAINT constraint_name ]
    { NOT NULL | NULL |
      CHECK ( expression ) [ NO INHERIT ] |
      DEFAULT default_expr |
      GENERATED ALWAYS AS ( generation_expr ) STORED |
      GENERATED { ALWAYS | BY DEFAULT } AS IDENTITY [ ( sequence_options ) ] |
      UNIQUE [ NULLS [ NOT ] DISTINCT ] 🟣index_parameters |
      PRIMARY KEY index_parameters |
      REFERENCES reftable [ ( refcolumn ) ] [ MATCH FULL | MATCH PARTIAL | MATCH SIMPLE ]
        [ ON DELETE referential_action ] [ ON UPDATE referential_action ] }
    [ DEFERRABLE | NOT DEFERRABLE ] [ INITIALLY DEFERRED | INITIALLY IMMEDIATE ]

    【🟢like_option】
    { INCLUDING | EXCLUDING }
    { COMMENTS | COMPRESSION | CONSTRAINTS | DEFAULTS | GENERATED | IDENTITY | INDEXES | STATISTICS | STORAGE | ALL }

- ENTRY:
  EXPLAIN: 作成中
  BODY: |
    作成中
