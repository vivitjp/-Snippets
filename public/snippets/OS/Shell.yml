---
#-------------------------------
# Shell
#-------------------------------
- ENTRY:
  EXPLAIN: Shell
  BODY: |
    ■ 概要

    ・シェルは、ユーザーとオペレーティングシステム間のインターフェースを提供するプログラム
    ・コマンドラインインターフェース (CLI) やスクリプト言語として機能
    ・代表的なシェルには、Bash、Zsh、Fish などがある

    ■ 主な機能

    ・コマンドの実行: ユーザーが入力したコマンドを解釈して実行
    ・スクリプトの実行: 複数のコマンドをまとめたスクリプトを実行可能
    ・環境変数の管理: システムやユーザー固有の設定を環境変数として管理
    ・入出力リダイレクト: コマンドの入力や出力をファイルや他のコマンドにリダイレクト可能
    ・パイプライン: 複数のコマンドを連結してデータを渡すことが可能

    ■ 利点

    ・柔軟性: 多様なタスクを自動化できる
    ・効率性: 繰り返し作業をスクリプト化して効率化
    ・カスタマイズ性: ユーザーの好みに合わせてシェル環境をカスタマイズ可能

    ■ 注意点

    ・セキュリティ: スクリプト内でのコマンド実行に注意が必要
    ・互換性: 異なるシェル間でスクリプトの互換性に注意が必要
    ・学習曲線: シェルスクリプトの習得には時間がかかる場合がある

- ENTRY:
  EXPLAIN: Shell タイプ
  BODY: |
    ■ 代表的なシェルの種類

    ・Bash (Bourne Again SHell): Linux や macOS で広く使用されるデフォルトのシェル
    ・Zsh (Z Shell): 高度な機能とカスタマイズ性を持つシェル、Oh My Zsh などのフレームワークが人気
    ・Fish (Friendly Interactive SHell): ユーザーフレンドリーなインターフェースと自動補完機能が特徴
    ・Tcsh (TENEX C Shell): C シェルの拡張版で、C 言語風の構文を持つ
    ・Ksh (Korn Shell): 高度なスクリプト機能を提供するシェル

    ■ シェルの選択

    ・用途や好みに応じて適切なシェルを選択
    ・特定のプロジェクトや環境で推奨されるシェルを使用することも考慮

    ■ Bash

    ・特徴:    デフォルトで広く使用され、豊富なドキュメントとサポートがある
    ・利点:    安定性と互換性が高い
    ・注意点:  他のシェルに比べてカスタマイズ性が低い場合がある

    ■ Zsh

    ・特徴:    高度な機能とプラグインシステムを持つ
    ・利点:    カスタマイズ性が高く、開発者に人気
    ・注意点:  初心者には設定が複雑に感じられる場合がある

    ■ Fish

    ・特徴:    ユーザーフレンドリーな設計と自動補完機能が充実
    ・利点:    直感的な操作が可能で、初心者にも
    ・注意点:  他のシェルと互換性が低い場合がある

- ENTRY:
  EXPLAIN: Shell スクリプト
  BODY: |
    ■ Shell スクリプトの概要

    ・シェルで実行される一連のコマンドをまとめたテキストファイル
    ・タスクの自動化や繰り返し作業の効率化に使用される

    ■ 基本構文

    ・シバン (Shebang): スクリプトの最初に記述し、使用するシェルを指定
      
      #!/bin/bash

    ・コメント: # で始まる行はコメントとして扱われる
      
      # これはコメントです

    ・変数: 変数は値を格納するために使用され、$で参照

        NAME="World"
        echo "Hello, $NAME"

    ・条件分岐: if 文を使用して条件に応じた処理を実行

        if [ "$NAME" = "World" ]; then    // 空白は必須
          echo "Hello, World"
        else
          echo "Hello, Stranger"
        fi

    ・ループ: for や while を使用して繰り返し処理を実行

        for i in 1 2 3; do
          echo "Number: $i"
        done

    ■ 実行方法

    ・スクリプトに実行権限を付与: chmod +x script.sh
    ・スクリプトを実行: ./script.sh

- ENTRY:
  EXPLAIN: |
    サンプル: 簡単なバックアップスクリプト
  BODY: |
    #!/bin/bash

    # バックアップ元とバックアップ先のディレクトリを指定
    SOURCE_DIR="/path/to/source"
    BACKUP_DIR="/path/to/backup"

    # 日付を取得
    DATE=$(date +%Y%m%d_%H%M%S)

    # バックアップファイル名を作成
    BACKUP_FILE="$BACKUP_DIR/backup_$DATE.tar.gz"

    # バックアップを作成
    tar -czf $BACKUP_FILE $SOURCE_DIR

    echo "Backup completed: $BACKUP_FILE"

- ENTRY:
  EXPLAIN: |
    サンプル: ディスク使用量監視スクリプト
  BODY: |
    #!/bin/bash

    # 監視するディレクトリを指定
    MONITOR_DIR="/path/to/monitor"

    # 使用量の閾値を指定（例: 80%）
    THRESHOLD=80

    # ディスク使用量を取得
    USAGE=$(df -h $MONITOR_DIR | awk 'NR==2 {print $5}' | sed 's/%//')

    # 使用量が閾値を超えた場合に警告を表示
    if [ $USAGE -gt $THRESHOLD ]; then
      echo "Warning: Disk usage in $MONITOR_DIR is at ${USAGE}%"
    else
      echo "Disk usage in $MONITOR_DIR is at ${USAGE}%, within safe limits."
    fi

- ENTRY:
  EXPLAIN: 文法
  BODY: |
    ■ 文法

    ■ 概要
    ・シェルスクリプトの基本的な文法と動作をやさしく解説

    ■ Shebang（シバン）

    ・スクリプト先頭で実行するインタプリタを指定
    ・例: #!/bin/bash
    ・推奨例: #!/usr/bin/env bash（移植性向上）

    ■ コメント

    ・行頭の # はコメント扱い
    ・設定や注意点はコメントで残す

    ■ トークンと空白

    ・空白でトークンを区切る（コマンド名、引数、演算子など）
    ・空白を含む引数はクォートで囲む

    ■ 変数（代入と展開）

    ・代入は等号の両側に空白を入れない
    ・例: NAME="World"
    ・展開は $NAME または ${NAME} を使用

    ■ クォートのルール

    ・シングルクォート '...' は完全リテラル（展開なし）
    ・ダブルクォート "..." は変数展開とコマンド置換を許可
    ・未クォートはワイルドカード展開やフィールド分割が発生

    ■ コマンド置換とサブシェル

    ・コマンド置換: $(cmd) または `cmd` を使用して出力を取得
    ・例: DATE=$(date +%Y%m%d)
    ・サブシェル ( ... ) は親の環境を変更しない
    ・グループ化 { ...; } は現在のシェルで実行

    ■ 算術評価

    ・$(( ... )) で整数演算を実行
    ・例: i=$((i+1))

    ■ 条件評価（テスト）

    ・POSIX形式: [ ... ] を使用（トークン間にスペース必須）
    ・Bash拡張: [[ ... ]] を使用すると柔軟で安全
    ・主なファイルテスト: -e -f -d -r -w -x
    ・数値比較: -lt -gt -eq -ne -le -ge

    ■ 条件分岐と選択

    ・if 構文で条件分岐を記述
      if [ condition ]; then
        # true の処理
      elif [ other ]; then
        # 別の条件
      else
        # false の処理
      fi

    ・case 構文で複数パターンを処理
      case "$val" in
        pattern1) ... ;;
        pattern2) ... ;;
      esac

    ■ ループ

    ・for ループでリストを反復処理

      for item in a b c; do
        echo "$item"
      done

    ・while で行を読み込む例

      while read line; do
        echo "$line"
      done < file.txt

    ■ 関数

      myfunc() {
        echo "Hello"
        return 0
      }

    ・位置引数は "$1", "$2", 全引数は "$@" を使用

    ■ パイプと終了ステータス

    ・cmd1 | cmd2 で出力を次に渡す
    ・$? は直近のコマンドの終了コードを返す
    ・堅牢性向上には `set -o pipefail` を検討

    ■ リダイレクトとファイル記述子

    ・> は上書き、>> は追記、< は入力リダイレクト
    ・標準エラーは 2>error.log でリダイレクト
    ・標準出力と標準エラーを同時にリダイレクトする方法を理解する

    ■ ヒアドキュメント

    ・複数行リテラルを渡す例
      cat <<'EOF'
      複数行のテキスト
      EOF
    ・<<'EOF' は展開を無効化してリテラル扱いにする

    ■ ジョブ制御とバックグラウンド

    ・command & でバックグラウンド実行
    ・jobs, fg, bg, kill, wait を使って管理

    ■ シェルの安全設定とデバッグ

    ・推奨設定: set -euo pipefail
    ・IFS を適切に設定してフィールド分割を制御
    ・デバッグ時は set -x を使用してコマンドを表示

    ■ ベストプラクティス

    ・変数は常にクォートして使用する "$var"
    ・eval を極力避ける
    ・出力には printf を使う
    ・重要な操作は確認やバックアップを行う

    ■ POSIX互換性

    ・移植性を重視する場合は POSIX sh 準拠を優先
    ・Bash 拡張は移植性を下げる点に注意
