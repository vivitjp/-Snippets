#-------------------------------
# DynamoDB
#-------------------------------
- ENTRY:
  EXPLAIN: æ¦‚è¦
  BODY: |
    â–  æ¦‚è¦

    ãƒ»AWSã®ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰NoSQLã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆDB
    ãƒ»ã‚µãƒ¼ãƒãƒ¬ã‚¹ã€‚å®¹é‡ãƒ»ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã®è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒ«
    ãƒ»å˜ä¸€æ¡ãƒŸãƒªç§’ã®ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã€é«˜å¯ç”¨ãƒ»è€ä¹…æ€§(ãƒãƒ«ãƒAZ)
    ãƒ»ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã¨ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ã®2ç¨®ã®ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ‰

    â–  ä½œæˆ

    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«åãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼(ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼å¿…é ˆã€ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ä»»æ„)ã‚’å®šç¾©
    ãƒ»ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ‰é¸æŠ(ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ / ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰)
    ãƒ»ã‚³ãƒ³ã‚½ãƒ¼ãƒ« / CLI / CloudFormation / SDK ã§ä½œæˆå¯èƒ½

    â–  æ³¨æ„

    ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼è¨­è¨ˆãŒãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ã‚³ã‚¹ãƒˆã«ç›´çµ
    ãƒ»ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…ˆã«æ¤œè¨
    ãƒ»ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ã¯æœªä½¿ç”¨æ™‚ã‚‚èª²é‡‘
    ãƒ»é–‹ç™ºãƒ»ä½ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰æ¤œè¨
    ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ã‚µã‚¤ã‚ºä¸Šé™ 400KB
    ãƒ»å¤§å®¹é‡ã¯S3å‚ç…§ + DynamoDBã§ãƒ¡ã‚¿ç®¡ç†

    â–  RDBã¨ã®å·®ç•°

    ãƒ»ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¹(ã‚¢ã‚¤ãƒ†ãƒ ã”ã¨ã«å±æ€§å¯å¤‰)
    ãƒ»JOINãªã—
    ãƒ»é›†è¨ˆã¯ã‚¢ãƒ—ãƒªå´ or Athenaç­‰
    ãƒ»ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€Œãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã€APIã§è¤‡æ•°ã‚¢ã‚¤ãƒ†ãƒ ã®æ¡ä»¶ä»˜ãæ›¸ãè¾¼ã¿ã«å¯¾å¿œ
    ãƒ»ã‚¯ã‚¨ãƒªã¯ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ãƒ»GSIãƒ»LSIã«é™å®š
    ãƒ»ãƒ•ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã¯éæ¨å¥¨

    â–  ã‚¹ã‚­ãƒ¼ãƒ

    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã§æ±ºã¾ã‚‹ã®ã¯ã‚­ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ(ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ãƒ»ã‚½ãƒ¼ãƒˆã‚­ãƒ¼)ã¨ LSI/GSI ã ã‘
    ãƒ»RDB ã®ã‚ˆã†ãªã€Œå…¨è¡Œã§å…±é€šã®åˆ—ã‚’å¼·åˆ¶ã™ã‚‹ã€ã‚¹ã‚­ãƒ¼ãƒã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ã«ã¯ãªã„
    ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ã”ã¨ã«å±æ€§ã¯å¯å¤‰(ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¹)
    ãƒ»ã‚¹ã‚­ãƒ¼ãƒã‚ã‚Šã®ã‚ˆã†ã«æ‰±ã†å ´åˆ: ã‚¢ãƒ—ãƒªå±¤ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹
    ãƒ»ã¾ãŸã¯ Amplify ã® @model / GraphQL ã§å‹ã‚’å®šç¾©ã—ã‚¢ãƒ—ãƒªå´ã§å®ˆã‚‹
    ãƒ»DynamoDB API è‡ªä½“ã¯åˆ—ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ãƒ»å¼·åˆ¶ã—ãªã„

- ENTRY:
  EXPLAIN: ä½œæˆãƒ„ãƒ¼ãƒ«
  BODY: |
    â–  ã‚³ãƒ³ã‚½ãƒ¼ãƒ«

    ãƒ»DynamoDB
      â†’ ãƒ†ãƒ¼ãƒ–ãƒ«
      â†’ ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
        ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«åãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼(å¿…é ˆ)ãƒ»ã‚½ãƒ¼ãƒˆã‚­ãƒ¼(ä»»æ„)ãƒ»ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ã‚’å…¥åŠ›

      ä¾‹:
      ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«å: MyTable                // ãƒ†ãƒ¼ãƒ–ãƒ«åã¯ä¸€æ„ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹
      ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: id              // å¿…é ˆ
      ãƒ»ã‚½ãƒ¼ãƒˆã‚­ãƒ¼: ãªã—                   // ä»»æ„
      ãƒ»ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£: ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰          // ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰/ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰
      ãƒ»ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ‰: ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰     // ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰/ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰

    â–  CLI

    ãƒ»create-table ã§ãƒ†ãƒ¼ãƒ–ãƒ«åãƒ»ã‚­ãƒ¼ã‚¹ã‚­ãƒ¼ãƒãƒ»ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ã‚’æŒ‡å®š

      aws dynamodb create-table \
        --table-name MyTable \
        --attribute-definitions AttributeName=id,AttributeType=S \
        --key-schema AttributeName=id,KeyType=HASH \
        --billing-mode PAY_PER_REQUEST

    â–  CloudFormation

    ãƒ»AWS::DynamoDB::Table ã§ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã€‚DeletionPolicy ã§å‰Šé™¤ä¿è­·ã‚‚å¯èƒ½

      MyTable:
        Type: AWS::DynamoDB::Table
        Properties:
          TableName: MyTable
          BillingMode: PAY_PER_REQUEST
          AttributeDefinitions:
            - AttributeName: id
              AttributeType: S
          KeySchema:
            - AttributeName: id
              KeyType: HASH

    â–  SDK (Node.js)

    ãƒ»DynamoDBClient ã¨ CreateTableCommand ã§ä½œæˆ

      import { DynamoDBClient, CreateTableCommand } from '@aws-sdk/client-dynamodb';

      const client = new DynamoDBClient({});
      await client.send(new CreateTableCommand({
        TableName: 'MyTable',
        AttributeDefinitions: [{ AttributeName: 'id', AttributeType: 'S' }],
        KeySchema: [{ AttributeName: 'id', KeyType: 'HASH' }],
        BillingMode: 'PAY_PER_REQUEST',
      }));

- ENTRY:
  EXPLAIN: äºˆç´„èª
  BODY: |
    â–  æ¦‚è¦

    ãƒ»å¼ã§å±æ€§åã«ä½¿ã†ã¨è¡çªã™ã‚‹èªãŒã‚ã‚‹
    ãƒ»KeyConditionExpression / ConditionExpression / UpdateExpression ç­‰
    ãƒ»è¡çªæ™‚ã¯ #ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ ã¨ ExpressionAttributeNames ã§ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’æ¸¡ã™
    ãƒ»å¤§æ–‡å­—å°æ–‡å­—ã¯åŒºåˆ¥ãªã—
    ãƒ»ä¾‹: name, type, value, date, key, count, status, data, comment, order, group, 
          user, item, number, end, from, to, ... 500èªä»¥ä¸Š

    â–  äºˆç´„èªã® name ãŒã©ã“ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹

    ãƒ»DynamoDB ã®å¼ã®æ§‹æ–‡ã§ã¯ "name" ã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¨ã—ã¦ä½¿ã‚ã‚Œã¦ã„ãªã„
    ãƒ»SQL ã® ORDER BY ã® ORDER ã®ã‚ˆã†ã«ã€å¼ã®æ–‡æ³•ã®ã©ã“ã‹ã« name ã¨ã„ã†èªãŒç™»å ´ã™ã‚‹ã‚ã‘ã§ã¯ãªã„
    ãƒ»äºˆç´„èªãƒªã‚¹ãƒˆã« "name" ãŒè¼‰ã£ã¦ã„ã‚‹ã ã‘
    ãƒ»å¼ã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹ã¨ãã€å±æ€§åã¨ã—ã¦æ›¸ã‹ã‚ŒãŸèªãŒãã®ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹
    ãƒ»å«ã¾ã‚Œã¦ã„ã‚Œã°ã€Œäºˆç´„èªãªã®ã§å±æ€§åã¨ã—ã¦ã¯ä½¿ãˆãªã„ã€ã¨ã‚¨ãƒ©ãƒ¼ã«ã™ã‚‹
    ãƒ»ã¤ã¾ã‚Š "name" ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã®ã¯ã€ãã®ãƒã‚§ãƒƒã‚¯æ™‚ã®ãƒªã‚¹ãƒˆå‚ç…§ã ã‘ã€‚æ§‹æ–‡ä¸Šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ã¯ãªã„

    â–  äºˆç´„èªã‚’å›é¿ã™ã‚‹æ–¹æ³•

    ãƒ»UpdateExpression ã§å±æ€§ name ã‚’æ›´æ–°ã™ã‚‹ã¨ã
      ãƒ»"SET name = :val" ã¯ã‚¨ãƒ©ãƒ¼
      ãƒ»"SET #n = :val" ã¨ ExpressionAttributeNames: { '#n': 'name' } ã§å›é¿
    ãƒ»ConditionExpression ã§å±æ€§ type ã‚’æ¡ä»¶ã«ã™ã‚‹ã¨ã
      ãƒ»"type = :t" ã¯ã‚¨ãƒ©ãƒ¼
      ãƒ»"#t = :t" ã¨ ExpressionAttributeNames: { '#t': 'type' } ã§å›é¿
    ãƒ»ProjectionExpression ã§å±æ€§ value ã ã‘è¿”ã™ã¨ã
      ãƒ»"value" ã¯ã‚¨ãƒ©ãƒ¼
      ãƒ»"#v" ã¨ ExpressionAttributeNames: { '#v': 'value' } ã§å›é¿

    â–  ä¾‹(UpdateItem ã§ name ã‚’æ›´æ–°)

    UpdateExpression: 'SET #n = :name',
    ExpressionAttributeNames: { '#n': 'name' },
    ExpressionAttributeValues: marshall({ ':name': 'æ–°ã—ã„åå‰' }),

- ENTRY:
  EXPLAIN: RCU & WCU
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‹ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆå˜ä½
    ãƒ»ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ãƒ¢ãƒ¼ãƒ‰ã§ã¯ RCU/WCU ã‚’äº‹å‰ã«è¨­å®šã—ãªã„(ä½¿ç”¨é‡ã«å¿œã˜ã¦èª²é‡‘)

    â–  RCU(Read Capacity Unit)

    ãƒ»1 RCU = 1ç§’ã‚ãŸã‚Š 4KB ã¾ã§ã®å¼·åŠ›æ•´åˆæ€§èª­ã¿å–ã‚Š 1å›ã€ã¾ãŸã¯ 8KB ã¾ã§ã®çµæœæ•´åˆæ€§èª­ã¿å–ã‚Š 1å›
    ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ã‚µã‚¤ã‚ºãŒ 4KB ã‚’è¶…ãˆã‚‹ã¨è¤‡æ•° RCU ã‚’æ¶ˆè²»
    ãƒ»çµæœæ•´åˆæ€§èª­ã¿å–ã‚Šã¯åŒã˜ã‚¢ã‚¤ãƒ†ãƒ ã§ã‚‚å¼·åŠ›æ•´åˆæ€§ã®ç´„åŠåˆ†ã® RCU

    â–  WCU(Write Capacity Unit)

    ãƒ»1 WCU = 1ç§’ã‚ãŸã‚Š 1KB ã¾ã§ã®æ›¸ãè¾¼ã¿ 1å›
    ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ã‚µã‚¤ã‚ºãŒ 1KB ã‚’è¶…ãˆã‚‹ã¨è¤‡æ•° WCU ã‚’æ¶ˆè²»
    ãƒ»1å›ã® PutItem / UpdateItem / DeleteItem ãŒ 1 ã‚¢ã‚¤ãƒ†ãƒ åˆ†ã® WCU ã‚’æ¶ˆè²»

    â–  ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰æ™‚ã®è¨­è¨ˆ

    ãƒ»ãƒ”ãƒ¼ã‚¯æ™‚ã®èª­ã¿æ›¸ããƒ¬ãƒ¼ãƒˆã‚’è¦‹ç©ã‚‚ã‚Šã€RCU/WCU ã‚’è¨­å®š
    ãƒ»ä¸è¶³ã™ã‚‹ã¨ ThrottlingException ãŒè¿”ã‚Šãƒªãƒˆãƒ©ã‚¤ãŒå¿…è¦
    ãƒ»ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã§è² è·ã«å¿œã˜ã¦ RCU/WCU ã‚’å¢—æ¸›å¯èƒ½

- ENTRY:
  EXPLAIN: Consistent(æ•´åˆæ€§)
  BODY: |
    â–  æ¦‚è¦

    ãƒ»DynamoDB ã®ã€Œèª­ã¿å–ã‚Šã€ã«ã¯ã€Œçµæœæ•´åˆæ€§ã€ã¨ã€Œå¼·åŠ›æ•´åˆæ€§ã€ã®2ç¨®é¡
    ãƒ»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯çµæœæ•´åˆæ€§
    ãƒ»å¼·åŠ›æ•´åˆæ€§ã«ã¯ GetItem / Query / Scan ã§ ConsistentRead: true æŒ‡å®š

    â–  çµæœæ•´åˆæ€§(Eventually Consistent Read)

    ãƒ»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®èª­ã¿å–ã‚Šãƒ¢ãƒ‡ãƒ«
    ãƒ»ç›´å‰ã«å®Œäº†ã—ãŸæ›¸ãè¾¼ã¿ãŒåæ˜ ã•ã‚Œã¦ã„ãªã„å¿œç­”ãŒè¿”ã‚‹å ´åˆãŒã‚ã‚‹(å¤ã„ãƒ‡ãƒ¼ã‚¿ãŒè¿”ã‚‹å¯èƒ½æ€§)
    ãƒ»é€šå¸¸ 1 ç§’ä»¥å†…ã«ãƒ¬ãƒ—ãƒªã‚«é–“ã§åæ˜ ã•ã‚Œã‚‹
    ãƒ»æ¶ˆè²»ã™ã‚‹èª­ã¿å–ã‚Šã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ã¯å¼·åŠ›æ•´åˆæ€§ã®ç´„åŠåˆ†(åŒã˜ã‚¢ã‚¤ãƒ†ãƒ å–å¾—ã§ã‚‚ RCU ãŒå°‘ãªã„)
        â€» RCU: Read Capacity UnitãŒå°‘ãªã„åˆ©ç‚¹
                ãƒ»èª­ã¿å–ã‚Šã‚³ã‚¹ãƒˆãŒä½ããªã‚‹
                ãƒ»èª­ã¿å–ã‚Šã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆãŒé«˜ããªã‚‹
                ãƒ»èª­ã¿å–ã‚Šãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãŒä½ããªã‚‹
        â€» WCU: Write Capacity UnitãŒå¤šã„ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
                ãƒ»æ›¸ãè¾¼ã¿ã‚³ã‚¹ãƒˆãŒé«˜ããªã‚‹
                ãƒ»æ›¸ãè¾¼ã¿ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆãŒä½ããªã‚‹
                ãƒ»æ›¸ãè¾¼ã¿ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãŒé«˜ããªã‚‹
    ãƒ»çµæœæ•´åˆæ€§ã®æ–¹ãŒã‚³ã‚¹ãƒˆãŒå®‰ããªã‚‹
    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»LSIãƒ»GSI ã®ã„ãšã‚Œã§ã‚‚åˆ©ç”¨å¯èƒ½
        â€» LSI: Local Secondary Indexã®ç•¥
        â€» GSI: Global Secondary Indexã®ç•¥

    â–  å¼·åŠ›æ•´åˆæ€§(Strongly Consistent Read)

    ãƒ»ãã®æ™‚ç‚¹ã¾ã§ã«æˆåŠŸã—ãŸæ›¸ãè¾¼ã¿ãŒã™ã¹ã¦åæ˜ ã•ã‚ŒãŸæœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿ãŒè¿”ã‚‹
    ãƒ»GetItem / Query / Scan ã§ ConsistentRead: true ã‚’æŒ‡å®šã§å¼·åŠ›æ•´åˆæ€§
    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ LSI ã®ã¿ã‚µãƒãƒ¼ãƒˆ
    ãƒ»GSI ã¨ DynamoDB Streams ã§ã¯æŒ‡å®šä¸å¯
    ãƒ»çµæœæ•´åˆæ€§ã‚ˆã‚Šé…å»¶ãŒå¤§ãããªã‚‹å ´åˆãŒã‚ã‚Šã€æ¶ˆè²» RCU ã‚‚ç´„2å€

    â–  ãªãœ2ç¨®é¡ã‚ã‚‹ã‹

    ãƒ»DynamoDB ã¯ãƒãƒ«ãƒ AZ ã§è¤‡æ•°ãƒ¬ãƒ—ãƒªã‚«ã«ãƒ‡ãƒ¼ã‚¿è¤‡è£½
    ãƒ»çµæœæ•´åˆæ€§: ã„ãšã‚Œã‹ã®ãƒ¬ãƒ—ãƒªã‚«ã‹ã‚‰èª­ã¿å–ã‚‹ãŸã‚å¿œç­”ãŒé€Ÿã„
                 -> æ›¸ãè¾¼ã¿ç›´å¾Œã®åæ˜ é…ã‚Œã‚’è¨±å®¹
    ãƒ»å¼·åŠ›æ•´åˆæ€§: ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¬ãƒ—ãƒªã‚«ãªã©æœ€æ–°ãŒç¢ºå®šã—ãŸãƒ¬ãƒ—ãƒªã‚«ã‹ã‚‰èª­ã‚€
                 -> æ›¸ãè¾¼ã¿åæ˜ ã‚’ä¿è¨¼ã™ã‚‹ä»£ã‚ã‚Šã«ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ»ã‚³ã‚¹ãƒˆå¢—åŠ 

    â–  ä½¿ã„åˆ†ã‘

    ãƒ»çµæœæ•´åˆæ€§ã§ã‚ˆã„ä¾‹:

      ä¸€è¦§è¡¨ç¤ºã€é›†è¨ˆã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ›´æ–°ã€æ›¸ãè¾¼ã¿ç›´å¾Œã®åŒä¸€ãƒ‡ãƒ¼ã‚¿å–å¾—ãŒå¿…é ˆ

    ãƒ»å¼·åŠ›æ•´åˆæ€§ã‚’ä½¿ã†ä¾‹:

      æ®‹é«˜ç¢ºèªã€åœ¨åº«å¼•ãå½“ã¦ã€äºŒé‡é€ä¿¡é˜²æ­¢ãªã©ã€Œå¿…ãšæœ€æ–°ã‚’èª­ã‚€ã€å¿…è¦

    â–  SDK ã§ã®æŒ‡å®šä¾‹

    GetItemCommand / QueryCommand / ScanCommand ã®å¼•æ•°ã§ ConsistentRead: true ã‚’ä»˜ã‘ã‚‹
    const result = await client.send(new GetItemCommand({
      TableName: 'Users',
      Key: marshall({ userId: 'U001' }),
      ConsistentRead: true,
    }));

- ENTRY:
  EXPLAIN: ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ãƒ¢ãƒ¼ãƒ‰ã§å‰²ã‚Šå½“ã¦ãŸ RCU/WCU ã‚’è¶…ãˆã‚‹ã¨ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ãŒç™ºç”Ÿ
    ãƒ»API ãŒ ThrottlingException(æ—§å ProvisionedThroughputExceededException) ã‚’è¿”ã™
    ãƒ»ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã§ã‚‚ä¸€æ™‚çš„ãªæ€¥å¢—æ™‚ã«ã¯ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ãŒèµ·ã“ã‚Šå¾—ã‚‹
    ãƒ»ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆé–¢é€£ã§é­é‡ã™ã‚‹æ©Ÿä¼šãŒæœ€ã‚‚å¤šã„ã‚¨ãƒ©ãƒ¼

    â–  ä¸»ãªåŸå› 

    ãƒ»ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ã® RCU/WCU ä¸è¶³
      ãƒ»ãƒ”ãƒ¼ã‚¯æ™‚ã®èª­ã¿æ›¸ããŒè¨­å®šå€¤ã‚’ä¸Šå›ã‚‹
      ãƒ»è¦‹ç©ã‚‚ã‚ŠãŒä½ã„ã€ã¾ãŸã¯è² è·å¢—åŠ å¾Œã®è¦‹ç›´ã—ä¸è¶³
    ãƒ»ãƒ›ãƒƒãƒˆãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³
      ãƒ»ç‰¹å®šã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã«ã ã‘ã‚¢ã‚¯ã‚»ã‚¹ãŒé›†ä¸­
      ãƒ»1ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã«ã¯ä¸Šé™ã‚ã‚Š
      ãƒ»å‡ç­‰ã«åˆ†æ•£ã•ã‚Œãªã„ã‚­ãƒ¼è¨­è¨ˆã‚„ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ç™ºç”Ÿã—ã‚„ã™ã„
    ãƒ»GSI/LSI ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆä¸è¶³
      ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“ã¯è¶³ã‚Šã¦ã„ã¦ã‚‚ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å´ã®ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ãŒä¸è¶³ã™ã‚‹ã¨ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°
    ãƒ»ãƒãƒ¼ã‚¹ãƒˆå¾Œã®ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰åˆ¶é™
      ãƒ»ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã¯ãƒãƒ¼ã‚¹ãƒˆè¨±å®¹ã‚ã‚Šã ãŒã€æ¥µç«¯ãªã‚¹ãƒ‘ã‚¤ã‚¯æ™‚ã¯åˆ¶é™ã«å½“ãŸã‚‹å ´åˆã‚ã‚Š

    â–  å¯¾å‡¦

    ãƒ»ãƒªãƒˆãƒ©ã‚¤ã¨æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•
      ãƒ»ThrottlingException ã¯ä¸€æ™‚çš„ãªéè² è·ãªã®ã§ã€é…å»¶ã‚’æŒŸã‚“ã§ãƒªãƒˆãƒ©ã‚¤ã™ã‚‹
      ãƒ»æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ã§ãƒªãƒˆãƒ©ã‚¤é–“éš”ã‚’å¾ã€…ã«ä¼¸ã°ã™ã¨æˆåŠŸç‡ãŒä¸ŠãŒã‚‹
      ãƒ»SDK ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒªãƒˆãƒ©ã‚¤ã‚„ jitter ä»˜ããƒãƒƒã‚¯ã‚ªãƒ•ã®åˆ©ç”¨ã‚’æ¨å¥¨
    ãƒ»ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ã®è¦‹ç›´ã—
      ãƒ»CloudWatch ã® ConsumedReadCapacityUnits / ConsumedWriteCapacityUnits ã¨è¨­å®šå€¤ã‚’æ¯”è¼ƒ
      ãƒ»ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã§ç›®æ¨™ä½¿ç”¨ç‡ã«åˆã‚ã›ã¦ RCU/WCU ã‚’è‡ªå‹•å¢—æ¸›
    ãƒ»ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã‚­ãƒ¼è¨­è¨ˆã®è¦‹ç›´ã—
      ãƒ»ãƒ›ãƒƒãƒˆãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’é¿ã‘ã‚‹ãŸã‚ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã‚’åˆ†æ•£ã•ã›ã‚‹(ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹/ã‚·ãƒ£ãƒ¼ãƒ‰)
      ãƒ»èª­ã¿æ›¸ãã‚’è¤‡æ•°ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«åˆ†æ•£ã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆ
    ãƒ»ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã¸ã®åˆ‡ã‚Šæ›¿ãˆæ¤œè¨
      ãƒ»è² è·ãŒå¤‰å‹•ã—ã‚„ã™ãè¦‹ç©ã‚‚ã‚ŠãŒé›£ã—ã„å ´åˆã¯ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã§ã‚¹ãƒ‘ã‚¤ã‚¯ã«ä»»ã›ã‚‹é¸æŠè‚¢ã‚ã‚Š

    â–  è£œè¶³

    ãƒ»ã‚¨ãƒ©ãƒ¼åã¯ SDK/API ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã‚Š ThrottlingException ã¾ãŸã¯ ProvisionedThroughputExceededException
    ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã§ã¯ UserErrors ã‚„ ThrottledRequests ã§ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ä»¶æ•°ã‚’ç¢ºèªå¯èƒ½

#-------------------------------
# ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
#-------------------------------

- ENTRY:
  CATEGORY: ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

- ENTRY:
  EXPLAIN: ãƒ†ãƒ¼ãƒ–ãƒ«
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ã®é›†åˆ
    ãƒ»åå‰ã¯ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å†…ã§ä¸€æ„
    ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼(å¿…é ˆ)ã¨ã‚½ãƒ¼ãƒˆã‚­ãƒ¼(ä»»æ„)ã§ä¸€æ„æ€§ã‚’ä¿è¨¼

    â–  ä¾‹(ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã®ã¿)

    import { DynamoDBClient, CreateTableCommand } from '@aws-sdk/client-dynamodb';

    const client = new DynamoDBClient({});
    await client.send(new CreateTableCommand({
      TableName: 'Users',
      AttributeDefinitions: [{ AttributeName: 'userId', AttributeType: 'S' }],
      KeySchema: [{ AttributeName: 'userId', KeyType: 'HASH' }],
      BillingMode: 'PAY_PER_REQUEST',
    }));

    â–  ä¾‹(ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ï¼‹ã‚½ãƒ¼ãƒˆã‚­ãƒ¼)

    import { DynamoDBClient, CreateTableCommand } from '@aws-sdk/client-dynamodb';

    await client.send(new CreateTableCommand({
      TableName: 'Orders',
      AttributeDefinitions: [
        { AttributeName: 'userId', AttributeType: 'S' },
        { AttributeName: 'orderId', AttributeType: 'S' },
      ],
      KeySchema: [
        { AttributeName: 'userId', KeyType: 'HASH' },
        { AttributeName: 'orderId', KeyType: 'RANGE' },
      ],
      BillingMode: 'PAY_PER_REQUEST',
    }));

    â–  ãƒ†ãƒ¼ãƒ–ãƒ«/LSI/GSI æ¯”è¼ƒ

    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«

      ãƒ»ãƒ¡ã‚¤ãƒ³ã®ãƒ‡ãƒ¼ã‚¿æ ¼ç´å…ˆ
      ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼(ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼å¿…é ˆã€ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ä»»æ„)ã§ä¸€æ„
      ãƒ»Query / GetItem ã®å¯¾è±¡

    ãƒ»LSI (Local Secondary Index)

      ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ã¨åŒä¸€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã ãŒã€ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ã ã‘åˆ¥å®šç¾©
      ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ™‚ã«ã®ã¿è¿½åŠ å¯èƒ½(å¾Œã‹ã‚‰è¿½åŠ ä¸å¯)
      ãƒ»å¼·åŠ›æ•´åˆæ€§èª­ã¿å–ã‚Šå¯èƒ½(ConsistentRead: true)
      ãƒ»ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã¨å…±æœ‰

    ãƒ»GSI (Global Secondary Index)

      ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã¨ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ç•°ãªã‚‹çµ„ã¿åˆã‚ã›ã§å®šç¾©å¯èƒ½
      ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆå¾Œã§ã‚‚è¿½åŠ å¯èƒ½
      ãƒ»å¼·åŠ›æ•´åˆæ€§èª­ã¿å–ã‚Šã¯ä¸å¯(çµæœæ•´åˆæ€§ã®ã¿)
      ãƒ»ç‹¬è‡ªã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã€ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰æ™‚ã¯åˆ¥é€” RCU/WCU

    ãƒ»ä½¿ã„åˆ†ã‘

      ãƒ»åŒä¸€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã§åˆ¥ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ã§ã®æ¤œç´¢ â†’ LSI
      ãƒ»åˆ¥ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã‚„ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆå¾Œã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ  â†’ GSI

- ENTRY:
  EXPLAIN: ã‚¢ã‚¤ãƒ†ãƒ 
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã®1ãƒ¬ã‚³ãƒ¼ãƒ‰
    ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã§ä¸€æ„
    ãƒ»å±æ€§ã®é›†åˆ
    ãƒ»æœ€å¤§ 400KB

    â€» SQLã¨ã®é•ã„ã«æ³¨æ„:
       ãƒ¬ã‚³ãƒ¼ãƒ‰ã«å®šå‹å±æ€§ãŒãªã„ã®ã§ã€æŒ¿å…¥ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¯ãƒ¬ã‚³ãƒ¼ãƒ‰ã”ã¨ã«ç•°ãªã£ã¦ã‚‚OK

    â–  ä¾‹(PutItemCommand ã§1ã‚¢ã‚¤ãƒ†ãƒ æŠ•å…¥)

    import { DynamoDBClient, PutItemCommand } from '@aws-sdk/client-dynamodb';
    import { marshall } from '@aws-sdk/util-dynamodb';

    const client = new DynamoDBClient({});

    await client.send(new PutItemCommand({
      TableName: 'Users',
      Item: marshall({ userId: 'U001', name: 'ç”°ä¸­', createdAt: '2024-01-01' }),
    }));

    // åŒã˜ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã€å±æ€§ã®é•ã†åˆ¥ã‚¢ã‚¤ãƒ†ãƒ ã‚’æŠ•å…¥å¯èƒ½(ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¹)ã€‚ã‚­ãƒ¼ãŒé•ã†ã®ã§ä¸¡æ–¹æ®‹ã‚‹
    await client.send(new PutItemCommand({
      TableName: 'Users',
      Item: marshall({ userId: 'U002', address: 'æ±äº¬', createdAt: '2024-01-01' }),
    }));

- ENTRY:
  EXPLAIN: å±æ€§
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ§‹æˆã™ã‚‹åå‰ã¨å€¤ã®ãƒšã‚¢
    ãƒ»ã‚¹ã‚­ãƒ¼ãƒå›ºå®šãªã—(ã‚¢ã‚¤ãƒ†ãƒ ã”ã¨ã«å±æ€§å¯å¤‰å¯)
    ãƒ»å‹: 
          S         æ–‡å­—åˆ— (String)
          N         æ•°å€¤ (Number)
          B         ãƒã‚¤ãƒŠãƒª (Binary)
          BOOL      çœŸå½å€¤ (Boolean)
          NULL      null (Null)
          M         ãƒãƒƒãƒ— (Map)
          L         ãƒªã‚¹ãƒˆ (List: JSONã®é…åˆ—)
          SS        æ–‡å­—åˆ—é›†åˆ (String Set)
          NS        æ•°å€¤é›†åˆ (Number Set)
          BS        ãƒã‚¤ãƒŠãƒªé›†åˆ (Binary Set)

    â–  marshall 

    ãƒ»JavaScript ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ â†’ DynamoDB å½¢å¼ã«å¤‰æ›

    import { marshall } from '@aws-sdk/util-dynamodb';

    const item = marshall({
      userId: 'U001',
      name: 'ç”°ä¸­',
      score: 100,
      tags: ['front', 'back'],
    });

    â€» DynamoDB å½¢å¼ => { 
      userId: { S: 'U001' },
      name: { S: 'ç”°ä¸­' },
      score: { N: '100' },
      tags: { SS: ['front', 'back'] }
    }

- ENTRY:
  EXPLAIN: ã‚­ãƒ¼
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼(HASH): å¿…é ˆ

      ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã®æ±ºå®šã«ä½¿ç”¨
      ãƒ»GetItemãƒ»Query ã§æŒ‡å®š
      â€»ã€Œãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã€ã‚­ãƒ¼ã¨å‘¼ã¶ç†ç”±
      ãƒ»å€¤ã®ãƒãƒƒã‚·ãƒ¥ã§æ ¼ç´å…ˆãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³(ç‰©ç†ã‚·ãƒ£ãƒ¼ãƒ‰)ãŒæ±ºã¾ã‚‹ãŸã‚
      ãƒ»RDBã®ä¸»ã‚­ãƒ¼ã¯ä¸€æ„ãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒç›®çš„
      ãƒ»DynamoDBã§ã¯ã€Œã©ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«è¼‰ã›ã‚‹ã‹ã€ãŒç¬¬ä¸€ã€ãã®ã‚­ãƒ¼ã§ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ãŒæ±ºå®š

    ãƒ»ã‚½ãƒ¼ãƒˆã‚­ãƒ¼(RANGE): ä»»æ„

      ãƒ»åŒä¸€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³å†…ã®ä¸¦ã³ãƒ»ç¯„å›²æŒ‡å®šã«ä½¿ç”¨
      ãƒ»GetItemãƒ»Query ã§æŒ‡å®š

    â–  ä¾‹(GetItemCommand / QueryCommand ã§ã‚­ãƒ¼æŒ‡å®š)

    import { DynamoDBClient, GetItemCommand, QueryCommand } from '@aws-sdk/client-dynamodb';
    import { marshall } from '@aws-sdk/util-dynamodb';

    const client = new DynamoDBClient({});
    await client.send(new GetItemCommand({
      TableName: 'Users',
      Key: marshall({ userId: 'U001' }),
    }));

    await client.send(new QueryCommand({
      TableName: 'Orders',
      KeyConditionExpression: 'userId = :uid',
      ExpressionAttributeValues: marshall({ ':uid': 'U001' }),
    }));

- ENTRY:
  EXPLAIN: å€¤
  BODY: |
    â–  æ¦‚è¦

    ãƒ»å±æ€§ã®å€¤ã€‚å‹ã«å¿œã˜ã¦ S/N/B/BOOL/M/L/SS/NS/BS ã§æ ¼ç´
    ãƒ»æ—¥æ™‚ã¯ ISO8601 æ–‡å­—åˆ—ã‚„ N(Unixæ™‚åˆ»)ãŒä¸€èˆ¬çš„

    â–  ä¾‹(unmarshall ã§ DynamoDB å½¢å¼ â†’ TS ã§æ‰±ã†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)

    import { DynamoDBClient, GetItemCommand, QueryCommand } from '@aws-sdk/client-dynamodb';
    import { unmarshall } from '@aws-sdk/util-dynamodb';

    const client = new DynamoDBClient({});
    const result = await client.send(new GetItemCommand({
      TableName: 'Users',
      Key: marshall({ userId: 'U001' }),
    }));

    const record = unmarshall({
      id: { S: 'U001' },
      name: { S: 'ç”°ä¸­' },
      score: { N: '100' },
      active: { BOOL: true },
    });
    // => { id: 'U001', name: 'ç”°ä¸­', score: 100, active: true }

- ENTRY:
  EXPLAIN: ã‚­ãƒ¼ãƒ»ã‚¹ã‚­ãƒ¼ãƒ
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ™‚ã«å®šç¾©
    ãƒ»AttributeDefinitions ã§å‹ã‚’å®£è¨€ã€KeySchema ã§ HASH/RANGE ã‚’å‰²ã‚Šå½“ã¦

    â–  ä¾‹(CreateTableCommand ã® AttributeDefinitions / KeySchema)

    import { CreateTableCommand } from '@aws-sdk/client-dynamodb';

    ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã®ã¿(é…åˆ—[1]ãªã—)
    AttributeDefinitions: [
      { AttributeName: 'id', AttributeType: 'S' }
    ],
    KeySchema: [
      { AttributeName: 'id', KeyType: 'HASH' }
    ],

    ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ï¼‹ã‚½ãƒ¼ãƒˆã‚­ãƒ¼(é…åˆ—[0]:ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼, é…åˆ—[1]:ã‚½ãƒ¼ãƒˆã‚­ãƒ¼)
    AttributeDefinitions: [
      { AttributeName: 'userId', AttributeType: 'S' },
      { AttributeName: 'orderId', AttributeType: 'S' },
    ],
    KeySchema: [
      { AttributeName: 'userId', KeyType: 'HASH' },
      { AttributeName: 'orderId', KeyType: 'RANGE' },
    ],

- ENTRY:
  EXPLAIN: ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ‰
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ™‚ã«æŒ‡å®š
    ãƒ»ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰(PAY_PER_REQUEST): ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
      ãƒ»èª­ã¿æ›¸ãé‡ã«å¿œã˜ã¦è‡ªå‹•èª²é‡‘
      ãƒ»ã‚¹ãƒ‘ã‚¤ã‚¯ã«å¼·ã„ (ã‚¹ãƒ‘ã‚¤ã‚¯: æ€¥ãªã‚¢ã‚¯ã‚»ã‚¹å¢—)
      ãƒ»é–‹ç™ºãƒ»å¤‰å‹•è² è·å‘ã‘
    ãƒ»ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰(PROVISIONED)
      ãƒ»RCU/WCU ã‚’äº‹å‰æŒ‡å®š
      ãƒ»ä¸€å®šè² è·ãƒ»ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Šå‘ã‘
      ãƒ»æœªä½¿ç”¨æ™‚ã‚‚èª²é‡‘
        ãƒ»RCU(Read Capacity Unit): 1ç§’ã‚ãŸã‚Šã®èª­ã¿å–ã‚Šæ“ä½œæ•°
        ãƒ»WCU(Write Capacity Unit): 1ç§’ã‚ãŸã‚Šã®æ›¸ãè¾¼ã¿æ“ä½œæ•°

    â–  ä¾‹(CreateTableCommand ã§ BillingMode / ProvisionedThroughput æŒ‡å®š)

    import { CreateTableCommand } from '@aws-sdk/client-dynamodb';
    import { ProvisionedThroughput } from '@aws-sdk/client-dynamodb';
    import { BillingMode } from '@aws-sdk/client-dynamodb';

    await client.send(new CreateTableCommand({
      TableName: 'Users',
      AttributeDefinitions: [{ AttributeName: 'userId', AttributeType: 'S' }],
      KeySchema: [{ AttributeName: 'userId', KeyType: 'HASH' }],
      BillingMode: 'PAY_PER_REQUEST',        // ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰
    }));  

    await client.send(new CreateTableCommand({
      TableName: 'Users',
      AttributeDefinitions: [{ AttributeName: 'userId', AttributeType: 'S' }],
      KeySchema: [{ AttributeName: 'userId', KeyType: 'HASH' }],
      BillingMode: 'PROVISIONED',            // ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰
      ProvisionedThroughput: {
        ReadCapacityUnits: 5,
        WriteCapacityUnits: 5,
      },
    }));

- ENTRY:
  EXPLAIN: ã‚­ãƒ¼å±æ€§ã®æ³¨æ„ç‚¹
  BODY: |
    â–  ä½œæˆæ—¥ã€æ›´æ–°æ—¥

    ãƒ»RDB ã® MySQL ã§ã¯ä½œæˆæ—¥ãƒ»æ›´æ–°æ—¥ãªã©ã®è‡ªå‹•æ›´æ–°ãŒå¯èƒ½ã€DynamoDB ã§ã¯è‡ªå‹•æ›´æ–°ãªã—
    ãƒ»createdAt / updatedAt ã¯ã‚¢ãƒ—ãƒªå´ã§ä»˜ä¸
    ãƒ»PutItem æ™‚ã« createdAt ã‚’ã‚»ãƒƒãƒˆã€UpdateItem æ™‚ã« updatedAt ã‚’ SET
    ãƒ»å‹ã¯æ–‡å­—åˆ—(ISO8601)ã‚„æ•°å€¤(Unix ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—)ã§ä¿æŒãŒä¸€èˆ¬çš„
    ãƒ»Amplify ã® @model ã§ã¯ createdAt / updatedAt ã®ã‚¹ã‚­ãƒ¼ãƒè‡ªå‹•è¿½åŠ ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã®è‡ªå‹•è¨­å®š

#-------------------------------
# SDK for DynamoDB
#-------------------------------

- ENTRY:
  CATEGORY: SDK

- ENTRY:
  EXPLAIN: ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§
  TABLE:
    OPTION:
      ALIGN:
        - left
        - left
        - left
      HAS_TITLE: true
      WIDTH:
        - 25%
        - 25%
    BODY: |
      ã‚³ãƒãƒ³ãƒ‰å	API Operation	èª¬æ˜
      CreateTableCommand	CreateTable	æ–°ã—ã„DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
      DeleteTableCommand	DeleteTable	æ—¢å­˜ã®DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤
      DescribeTableCommand	DescribeTable	DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã®æƒ…å ±ã‚’å–å¾—

      QueryCommand	Query	ç‰¹å®šã®æ¡ä»¶ã«åŸºã¥ã„ã¦ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¯ã‚¨ãƒª
      GetItemCommand	GetItem	ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å˜ä¸€ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’å–å¾—
      PutItemCommand	PutItem	ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ 
      UpdateItemCommand	UpdateItem	æ—¢å­˜ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ›´æ–°
      DeleteItemCommand	DeleteItem	ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å˜ä¸€ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’å‰Šé™¤
      ScanCommand	Scan	ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã®ã™ã¹ã¦ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¹ã‚­ãƒ£ãƒ³

      BatchGetItemCommand	BatchGetItem	è¤‡æ•°ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ä¸€æ‹¬ã§å–å¾—
      BatchWriteItemCommand	BatchWriteItem	è¤‡æ•°ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ä¸€æ‹¬ã§æ›¸ãè¾¼ã¿

- ENTRY:
  EXPLAIN: CreateTableCommand
  BODY: |
    â–  æ¦‚è¦

    ãƒ»æ–°ã—ã„DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                              ä½œæˆã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã®åå‰
    ãƒ»AttributeDefinitions: AttributeDefinition[]    ãƒ†ãƒ¼ãƒ–ãƒ«ã®å±æ€§å®šç¾©
        [{
          AttributeName: string
          AttributeType: string                      ã‚­ãƒ¼ã«ä½¿ç”¨ã™ã‚‹å ´åˆã¯ S / N / B ã®ã„ãšã‚Œã‹
        }]

    ãƒ»KeySchema: KeySchemaElement[]                  ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚­ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ
        [{
          AttributeName: string
          KeyType: string                            HASH / RANGE
        }]

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»BillingMode: BillingMode                       ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ‰
        "PAY_PER_REQUEST"                            ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
        "PROVISIONED"                                ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰(æœªä½¿ç”¨æ™‚ã‚‚èª²é‡‘)
    ãƒ»ProvisionedThroughput: ProvisionedThroughput   ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£è¨­å®š(BillingMode: PROVISIONED æ™‚)
    ãƒ»Tags: Tag[]                                    ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¿ã‚°
    ãƒ»StreamSpecification: StreamSpecification       ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®è¨­å®š
    ãƒ»SSESpecification: SSESpecification             ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰æš—å·åŒ–ã®è¨­å®š
    ãƒ»DeletionProtectionEnabled: boolean             ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤ä¿è­·(true / false)
    ãƒ»TableClass: TableClass                         ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¯ãƒ©ã‚¹(STANDARD / STANDARD_INFREQUENT_ACCESS)
    ãƒ»GlobalSecondaryIndexes: GlobalSecondaryIndex[] GSI å®šç¾©
    ãƒ»LocalSecondaryIndexes: LocalSecondaryIndex[]   LSI å®šç¾©
    ãƒ»OnDemandThroughput: OnDemandThroughput         ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰æœ€å¤§èª­ã¿æ›¸ããƒ¦ãƒ‹ãƒƒãƒˆ
    ãƒ»WarmThroughput: WarmThroughput                 ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ
    ãƒ»ResourcePolicy: string                         ãƒ†ãƒ¼ãƒ–ãƒ«ä»˜ä¸ãƒªã‚½ãƒ¼ã‚¹ãƒãƒªã‚·ãƒ¼

    â–  æˆ»ã‚Šå€¤(CreateTableCommandOutput)

    ãƒ»TableDescription: TableDescription             ãƒ†ãƒ¼ãƒ–ãƒ«èª¬æ˜
      // TableDescription å†…ã®ä¸»ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
      ãƒ»TableName: string                            ãƒ†ãƒ¼ãƒ–ãƒ«å
      ãƒ»TableArn: string                             ãƒ†ãƒ¼ãƒ–ãƒ«ARN
      ãƒ»TableId: string                              ãƒ†ãƒ¼ãƒ–ãƒ«ID
      ãƒ»TableStatus: string                          çŠ¶æ…‹(CREATING / ACTIVE ç­‰)
      ãƒ»TableSizeBytes: number                       ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆ)
      ãƒ»ItemCount: number                            ã‚¢ã‚¤ãƒ†ãƒ æ•°
      ãƒ»CreationDateTime: number                     ä½œæˆæ—¥æ™‚(UNIX ã‚¨ãƒãƒƒã‚¯)
    ãƒ»$metadata: ResponseMetadata                    RequestId ç­‰ã¯ $metadata.requestId ã§å–å¾—

    â–  ã‚µãƒ³ãƒ—ãƒ«(ãƒ¦ãƒ¼ã‚¶ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ)

    import { CreateTableCommand } from '@aws-sdk/client-dynamodb';

    const command = new CreateTableCommand({
      TableName: 'Users',
      AttributeDefinitions: [{ AttributeName: 'userId', AttributeType: 'S' }],
      KeySchema: [{ AttributeName: 'userId', KeyType: 'HASH' }],
      BillingMode: 'PAY_PER_REQUEST',
    });

    const result = await client.send(command);
    {
      TableDescription: {
        TableName: 'Users',
        TableArn: 'arn:aws:dynamodb:ap-northeast-1:123456789012:table/Users',
        TableId: '123456789012',
        TableStatus: 'ACTIVE',
        TableSizeBytes: 100,
        ItemCount: 100,
        CreationDateTime: 1717777777,
      },
      $metadata: {
        requestId: '123456789012',
        httpStatusCode: 200,
        httpHeaders: {
          'content-type': 'application/json',
        },
        retryable: false,
      },
    }

    â–  ã‚µãƒ³ãƒ—ãƒ«(å•†å“)

    ãƒ†ãƒ¼ãƒ–ãƒ«: Productsã€‚ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ productIdã€ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ category ã§ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«å–å¾—å¯èƒ½

    await client.send(new CreateTableCommand({
      TableName: 'Products',
      AttributeDefinitions: [
        { AttributeName: 'productId', AttributeType: 'S' },
        { AttributeName: 'category', AttributeType: 'S' },
      ],
      KeySchema: [
        { AttributeName: 'productId', KeyType: 'HASH' },
        { AttributeName: 'category', KeyType: 'RANGE' },
      ],
      BillingMode: 'PAY_PER_REQUEST',
    }));

    å•†å“1ä»¶ã®ä¾‹(PutItemCommand ã§æŠ•å…¥ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ):
    {
      productId: 'P001',
      category: 'electronics',
      name: 'ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³',
      price: 3980,
      stock: 50,
      createdAt: '2024-01-15T00:00:00Z',
    }

- ENTRY:
  EXPLAIN: DeleteTableCommand
  BODY: |
    â–  æ¦‚è¦

    ãƒ»æŒ‡å®šã—ãŸDynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤
    ãƒ»å‰Šé™¤é–‹å§‹å¾Œã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ DELETING çŠ¶æ…‹ã¨ãªã‚Šã€å®Œäº†ã¾ã§ DescribeTable ã§ç›£è¦–å¯èƒ½

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                   å‰Šé™¤ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«å/ãƒ†ãƒ¼ãƒ–ãƒ«ARN

    â–  æˆ»ã‚Šå€¤(DeleteTableCommandOutput)

    ãƒ»TableDescription: TableDescription  å‰Šé™¤å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã®èª¬æ˜(å‰Šé™¤é–‹å§‹æ™‚ç‚¹ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿)
      // TableDescription å†…ã®ä¸»ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
      ãƒ»TableName: string                 ãƒ†ãƒ¼ãƒ–ãƒ«å
      ãƒ»TableArn: string                  ãƒ†ãƒ¼ãƒ–ãƒ«ARN
      ãƒ»TableId: string                   ãƒ†ãƒ¼ãƒ–ãƒ«ID
      ãƒ»TableStatus: string               çŠ¶æ…‹(å‰Šé™¤é–‹å§‹ç›´å¾Œã¯ DELETING)
      ãƒ»TableSizeBytes: number            ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆ)
      ãƒ»ItemCount: number                 ã‚¢ã‚¤ãƒ†ãƒ æ•°
      ãƒ»CreationDateTime: number          ä½œæˆæ—¥æ™‚(UNIX ã‚¨ãƒãƒƒã‚¯)
    ãƒ»$metadata: ResponseMetadata         RequestId ç­‰ã¯ $metadata.requestId ã§å–å¾—

    â–  ã‚µãƒ³ãƒ—ãƒ«(ãƒ¦ãƒ¼ã‚¶ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤)

    import { DeleteTableCommand } from '@aws-sdk/client-dynamodb';

    const command = new DeleteTableCommand({
      TableName: 'Users',
    });

    const result = await client.send(command);
    {
      TableDescription: {
        TableName: 'Users',
        TableArn: 'arn:aws:dynamodb:ap-northeast-1:123456789012:table/Users',
        TableId: 'a1b2c3d4-e5f6-7890-abcd-ef1234567890',
        TableStatus: 'DELETING',  // ğŸ”´å‰Šé™¤ä¸­
        TableSizeBytes: 1024,
        ItemCount: 100,
        CreationDateTime: 1717777777,
        KeySchema: [
          { AttributeName: 'userId', KeyType: 'HASH' },
        ],
        AttributeDefinitions: [
          { AttributeName: 'userId', AttributeType: 'S' },
        ],
      },
      $metadata: {
        requestId: 'XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX',
        httpStatusCode: 200,
        httpHeaders: { 'content-type': 'application/x-amz-json-1.0' },
        retryable: false,
      },
    }

      â€» TableStatus ãŒ DELETING: å‰Šé™¤ä¸­ã€å‰Šé™¤å®Œäº†å¾Œã¯ TableStatus: DELETED
      â€» DescribeTable ã§ç›£è¦–å¯èƒ½
      â€» requestId ã®ç”¨é€”ã¯ã€ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§ä½¿ç”¨

    â–  ã‚µãƒ³ãƒ—ãƒ«(å•†å“ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤)

    await client.send(new DeleteTableCommand({
      TableName: 'Products',
    }));

- ENTRY:
  EXPLAIN: DescribeTableCommand
  BODY: |
    â–  æ¦‚è¦

    ãƒ»æŒ‡å®šã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿(ã‚¹ã‚­ãƒ¼ãƒãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ»ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆç­‰)ã‚’å–å¾—
    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆä¸­(CREATING)ã‚„å‰Šé™¤ä¸­(DELETING)ã®çŠ¶æ…‹ç¢ºèªã«ã‚‚åˆ©ç”¨

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                              å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«å/ãƒ†ãƒ¼ãƒ–ãƒ«ARN

    â–  æˆ»ã‚Šå€¤(DescribeTableCommandOutput)

    ãƒ»Table: TableDescription                        ãƒ†ãƒ¼ãƒ–ãƒ«èª¬æ˜(æœ¬ä½“)
        .TableName: string                            ãƒ†ãƒ¼ãƒ–ãƒ«å
        .TableArn: string                             ãƒ†ãƒ¼ãƒ–ãƒ«ARN
        .TableId: string                              ãƒ†ãƒ¼ãƒ–ãƒ«ID
        .TableStatus: string                          çŠ¶æ…‹(CREATING / ACTIVE / UPDATING / DELETING ç­‰)
        .TableSizeBytes: number                       ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆ)
        .ItemCount: number                            ã‚¢ã‚¤ãƒ†ãƒ æ•°
        .CreationDateTime: number                     ä½œæˆæ—¥æ™‚(UNIX ã‚¨ãƒãƒƒã‚¯)
        .KeySchema: KeySchemaElement[]                ã‚­ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ
        .AttributeDefinitions: AttributeDefinition[]  å±æ€§å®šç¾©
        .GlobalSecondaryIndexes: []                   GSI ä¸€è¦§
        .LocalSecondaryIndexes: []                    LSI ä¸€è¦§
        .ProvisionedThroughput: {}                    ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ³ãƒ‰æ™‚ã¯ RCU/WCU ç­‰
        .StreamSpecification: {}                      ã‚¹ãƒˆãƒªãƒ¼ãƒ è¨­å®š(æœ‰åŠ¹æ™‚)
    ãƒ»$metadata: ResponseMetadata  RequestId ç­‰ã¯ $metadata.requestId ã§å–å¾—

    â–  ã‚µãƒ³ãƒ—ãƒ«(ãƒ¦ãƒ¼ã‚¶ãƒ†ãƒ¼ãƒ–ãƒ«)

    import { DescribeTableCommand } from '@aws-sdk/client-dynamodb';

    const command = new DescribeTableCommand({
      TableName: 'Users',
    });

    const result = await client.send(command);
    {
      Table: {
        TableName: 'Users',
        TableArn: 'arn:aws:dynamodb:ap-northeast-1:123456789012:table/Users',
        TableId: 'a1b2c3d4-e5f6-7890-abcd-ef1234567890',
        TableStatus: 'ACTIVE',
        TableSizeBytes: 1024,
        ItemCount: 100,
        CreationDateTime: 1717777777,
        KeySchema: [
          { AttributeName: 'userId', KeyType: 'HASH' },
        ],
        AttributeDefinitions: [
          { AttributeName: 'userId', AttributeType: 'S' },
        ],
        GlobalSecondaryIndexes: [],
        LocalSecondaryIndexes: [],
        ProvisionedThroughput: {
          ReadCapacityUnits: 5,
          WriteCapacityUnits: 5,
        },
        StreamSpecification: {},
        $metadata: {
          requestId: 'XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX',
          httpStatusCode: 200,
          httpHeaders: { 'content-type': 'application/x-amz-json-1.0' },
          retryable: false,
        },
      },
    }

    â–  ã‚µãƒ³ãƒ—ãƒ«(å•†å“ãƒ†ãƒ¼ãƒ–ãƒ«)

    await client.send(new DescribeTableCommand({
      TableName: 'Products',
    }));

- ENTRY:
  EXPLAIN: QueryCommand è¤‡æ•°å–å¾—
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã§åŒä¸€ã‚­ãƒ¼ã‚’æŒã¤(è¤‡æ•°)ã‚¢ã‚¤ãƒ†ãƒ å–å¾—
    ãƒ»ã‚½ãƒ¼ãƒˆã‚­ãƒ¼æ¡ä»¶ã§ç¯„å›²æŒ‡å®šå¯èƒ½
    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»LSIãƒ»GSI ã«å¯¾ã—ã¦å®Ÿè¡Œå¯èƒ½
    ãƒ»FilterExpression ã¯ã‚­ãƒ¼æ¡ä»¶ã®å¾Œã«é©ç”¨ã•ã‚Œã€å–å¾—ä»¶æ•°ã«ã¯å«ã¾ã‚Œã‚‹ãŒè¿”å´ã¯ãƒ•ã‚£ãƒ«ã‚¿å¾Œ
    ãƒ»æˆ»ã‚Šå€¤è¤‡æ•°ã®é…åˆ—
    ãƒ»1å›ã® Query ã®æˆ»ã‚Šï¼ˆçµæœã‚»ãƒƒãƒˆï¼‰ã¯æœ€å¤§ 1MB ã¾ã§
    ãƒ»LastEvaluatedKey ãŒè¿”ã‚Œã°ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã§ç¶šãã‚’å–å¾—

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                   å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«åã¾ãŸã¯ãƒ†ãƒ¼ãƒ–ãƒ«ARN
    ãƒ»KeyConditionExpression: string      ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ç­‰ä¾¡å¿…é ˆã€ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ã¯æ¯”è¼ƒæ¼”ç®—å­ã§ä»»æ„
        ä¾‹: "userId = :uid"
        ä¾‹: "userId = :uid AND category BETWEEN :cat1 AND :cat2"
    ãƒ»ExpressionAttributeValues: Record<string, AttributeValue>
                                          KeyConditionExpression å†…ã® :name ã®å®Ÿéš›ã®å€¤
        { S: string }                     æ–‡å­—åˆ—
        { N: string }                     æ•°å€¤(ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã¯æ–‡å­—åˆ—ã§é€ã‚‹)
        { B: Uint8Array }                 ãƒã‚¤ãƒŠãƒª(API ã¯ Base64ã€‚JS/TS SDK ã§ã¯ Uint8Array)
        { BOOL: boolean }                 çœŸå½å€¤
        { NULL: true }                    null
        { M: Record<string, AttributeValue> }  ãƒãƒƒãƒ—(ãƒã‚¹ãƒˆå±æ€§)
        { L: AttributeValue[] }           ãƒªã‚¹ãƒˆ
        { SS: string[] }                  æ–‡å­—åˆ—é›†åˆ
        { NS: string[] }                  æ•°å€¤é›†åˆ(å„è¦ç´ ã¯æ–‡å­—åˆ—)
        { BS: Uint8Array[] }              ãƒã‚¤ãƒŠãƒªé›†åˆ(API ã¯ Base64 é…åˆ—ã€‚SDK ã§ã¯ Uint8Array[])

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»ExpressionAttributeNames: Record<string, string>
                                          å±æ€§åã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€(#name)ã€‚äºˆç´„èªå¯¾ç­–
    ãƒ»FilterExpression: string            ã‚­ãƒ¼æ¡ä»¶ã®å¾Œã«é©ç”¨ã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿(ã‚­ãƒ¼å±æ€§ã¯ä¸å¯)
    ãƒ»IndexName: string                   ã‚¯ã‚¨ãƒªå¯¾è±¡ã® LSI/GSI å
    ãƒ»Limit: number                       è©•ä¾¡ã™ã‚‹æœ€å¤§ã‚¢ã‚¤ãƒ†ãƒ æ•°(è¿”å´æ•°ã¯ Filter å¾Œã§å¤‰å‹•)
    ãƒ»ExclusiveStartKey: Record<string, AttributeValue>  
                                          å‰å›ã® LastEvaluatedKeyã€‚ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ç¶™ç¶š
    ãƒ»ScanIndexForward: boolean           true ã§ã‚½ãƒ¼ãƒˆã‚­ãƒ¼æ˜‡é †(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)ã€false ã§é™é †
    ãƒ»ConsistentRead: boolean             true ã§å¼·åŠ›æ•´åˆæ€§(GSI ã§ã¯ä¸å¯)
    ãƒ»ProjectionExpression: string        è¿”å´ã™ã‚‹å±æ€§ã®ãƒªã‚¹ãƒˆ
    ãƒ»ReturnConsumedCapacity: string      "NONE","TOTAL","INDEXES"

    â–  æˆ»ã‚Šå€¤(QueryCommandOutput) å…¨ä½“

    ãƒ»Items: Item[]
        å–å¾—ã•ã‚ŒãŸã‚¢ã‚¤ãƒ†ãƒ ã®é…åˆ—ã€‚å„è¦ç´ ã¯å±æ€§åã‚’ã‚­ãƒ¼ã€AttributeValue ã‚’å€¤ã¨ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        AttributeValue ã®å½¢ã¯å¼•æ•°ã¨åŒã˜(ä¸Šè¨˜ã„ãšã‚Œã‹1ã¤)
        ãƒ»{ S: string }  { N: string }  { B: Uint8Array }  { BOOL: boolean }  { NULL: true }
        ãƒ»{ M: Record<string, AttributeValue> }  { L: AttributeValue[] }  { SS: string[] }  { NS: string[] }  { BS: Uint8Array[] }

    ãƒ»Count: number
        FilterExpression é©ç”¨å¾Œã«è¿”å´ã•ã‚ŒãŸã‚¢ã‚¤ãƒ†ãƒ æ•°

    ãƒ»ScannedCount: number
        FilterExpression é©ç”¨å‰ã«è©•ä¾¡ã•ã‚ŒãŸã‚¢ã‚¤ãƒ†ãƒ æ•°ã€‚Filter ãªã—ãªã‚‰ Count ã¨åŒä¸€

    ãƒ»LastEvaluatedKey: Record<string, AttributeValue> | undefined
        ä»Šå›è¿”ã—ãŸæœ€å¾Œã®ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã€‚å­˜åœ¨ã™ã‚‹å ´åˆã¯ç¶šããŒã‚ã‚‹ãŸã‚ã€æ¬¡å› Query ã® ExclusiveStartKey ã«æŒ‡å®šã—ã¦ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹
        ç„¡ã„å ´åˆã¯å…¨ä»¶å–å¾—æ¸ˆã¿

    ãƒ»ConsumedCapacity: ConsumedCapacity | undefined
        ReturnConsumedCapacity æŒ‡å®šæ™‚ã®ã¿è¿”ã‚‹ã€‚
        CapacityUnits: number
        ReadCapacityUnits: number
        WriteCapacityUnits: number
        Table: { CapacityUnits, ReadCapacityUnits, WriteCapacityUnits } | undefined
        TableName: string | undefined
        GlobalSecondaryIndexes: Record<string, { CapacityUnits, ReadCapacityUnits, WriteCapacityUnits }> | undefined
        LocalSecondaryIndexes: Record<string, { CapacityUnits, ReadCapacityUnits, WriteCapacityUnits }> | undefined

    ãƒ»$metadata: ResponseMetadata
        requestId, httpStatusCode, httpHeaders ç­‰ã€‚

    â–  ã‚µãƒ³ãƒ—ãƒ«(ãƒ¦ãƒ¼ã‚¶ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã®ã¿)

    import { QueryCommand } from '@aws-sdk/client-dynamodb';
    import { marshall, unmarshall } from '@aws-sdk/util-dynamodb';

    const command = new QueryCommand({
      TableName: 'Users',
      KeyConditionExpression: 'userId = :uid',
      ExpressionAttributeValues: marshall({ ':uid': 'U001' }),
    });

    const result = await client.send(command);

    â–  ã‚µãƒ³ãƒ—ãƒ«(å•†å“ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ï¼‹ã‚½ãƒ¼ãƒˆã‚­ãƒ¼ç¯„å›²)

    const result = await client.send(new QueryCommand({
      TableName: 'Products',
      KeyConditionExpression: 'productId = :pid AND category BETWEEN :cat1 AND :cat2',
      ExpressionAttributeValues: marshall({
        ':pid': 'P001',
        ':cat1': 'electronics',
        ':cat2': 'sports',
      }),
    }));

    â–  result ã®ä¾‹(ç«¯æŠ˜ã‚‰ãš)

    {
      Items: [
        {
          productId: { S: 'P001' },
          category: { S: 'electronics' },
          name: { S: 'ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³' },
          price: { N: '3980' },
          stock: { N: '50' },
          createdAt: { S: '2024-01-15T00:00:00Z' },
        },
        {
          productId: { S: 'P001' },
          category: { S: 'sports' },
          name: { S: 'ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚·ãƒ¥ãƒ¼ã‚º' },
          price: { N: '8900' },
          stock: { N: '20' },
          createdAt: { S: '2024-01-16T00:00:00Z' },
        },
      ],
      Count: 2,
      ScannedCount: 2,
      LastEvaluatedKey: undefined,
      ConsumedCapacity: {
        TableName: 'Products',
        CapacityUnits: 0.5,
        ReadCapacityUnits: 0,
        WriteCapacityUnits: 0,
      },
      $metadata: {
        requestId: 'XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX',
        httpStatusCode: 200,
        httpHeaders: { 'content-type': 'application/x-amz-json-1.0' },
        retryable: false,
      },
    }

    â€» ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã¯ LastEvaluatedKey ãŒå­˜åœ¨ã™ã‚‹é™ã‚Šã€ExclusiveStartKey ã«è¨­å®šã—ã¦ Query ã‚’ç¹°ã‚Šè¿”ã™ã€‚

- ENTRY:
  EXPLAIN: GetItemCommand å˜æ•°å–å¾—
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’æŒ‡å®šã—ã¦ã€Œ1ã‚¢ã‚¤ãƒ†ãƒ ã€å–å¾—
    ãƒ»è©²å½“ã‚¢ã‚¤ãƒ†ãƒ ãŒç„¡ã„å ´åˆã¯ Item ãŒè¿”ã‚‰ãš(undefined)ã€ã‚¨ãƒ©ãƒ¼ã«ã¯ãªã‚‰ãªã„
    ãƒ»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯çµæœæ•´åˆæ€§èª­ã¿å–ã‚Š
    ãƒ»ConsistentRead: true ã§å¼·åŠ›æ•´åˆæ€§(ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ä¿è¨¼ã®ãŸã‚ã€èª­ã¿å–ã‚Šå®Œäº†ã¾ã§å¾…æ©Ÿ)

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                    å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«å/ãƒ†ãƒ¼ãƒ–ãƒ«ARN
    ãƒ»Key: Record<string, AttributeValue>  å–å¾—ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼
        ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã®ã¿ã®ãƒ†ãƒ¼ãƒ–ãƒ«
          { 
            partitionKeyName: { S: "value" }   // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼(å¿…é ˆ)
          }
        è¤‡åˆã‚­ãƒ¼(ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ï¼‹ã‚½ãƒ¼ãƒˆ)ã®ãƒ†ãƒ¼ãƒ–ãƒ«
          {
            partitionKeyName: { S: "value" },  // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼(å¿…é ˆ)
            sortKeyName: { S: "value" }        // ã‚½ãƒ¼ãƒˆã‚­ãƒ¼(1ä»¶ç‰¹å®šã®ãŸã‚å¿…é ˆ)
          }

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»ProjectionExpression: string          è¿”å´ã™ã‚‹å±æ€§ã®ã¿æŒ‡å®š
    ãƒ»ExpressionAttributeNames: Record<string, string> å±æ€§åã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€(#name)
    ãƒ»ConsistentRead: boolean               true ã§å¼·åŠ›æ•´åˆæ€§(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ false)
    ãƒ»ReturnConsumedCapacity: string        "NONE","TOTAL","INDEXES"

    â–  æˆ»ã‚Šå€¤(GetItemCommandOutput)

    ãƒ»Item: Record<string, AttributeValue> | undefined
        å–å¾—ã—ãŸ1ã‚¢ã‚¤ãƒ†ãƒ ã€‚ã‚­ãƒ¼ã«è©²å½“ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ãŒç„¡ã„å ´åˆã¯ undefinedã€‚
        å„å±æ€§å€¤ã¯ AttributeValue ã®å½¢(S / N / B / BOOL / NULL / M / L / SS / NS / BS)ã€‚
    ãƒ»ConsumedCapacity: ConsumedCapacity | undefined
        ReturnConsumedCapacity æŒ‡å®šæ™‚ã®ã¿ã€‚CapacityUnits, TableName, Table ç­‰ã€‚
    ãƒ»$metadata: ResponseMetadata
        requestId, httpStatusCode, httpHeaders ç­‰ã€‚

    â–  ã‚µãƒ³ãƒ—ãƒ«(ãƒ¦ãƒ¼ã‚¶ãƒ†ãƒ¼ãƒ–ãƒ«)

    import { GetItemCommand } from '@aws-sdk/client-dynamodb';
    import { marshall, unmarshall } from '@aws-sdk/util-dynamodb';

    const command = new GetItemCommand({
      TableName: 'Users',
      Key: marshall({ userId: 'U001' }),
    });

    const result = await client.send(command);
    const user = result.Item ? unmarshall(result.Item) : null;

    â–  ã‚µãƒ³ãƒ—ãƒ«(å•†å“ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»è¤‡åˆã‚­ãƒ¼)

    const result = await client.send(new GetItemCommand({
      TableName: 'Products',
      Key: marshall({ productId: 'P001', category: 'electronics' }),
    }));

    â–  result ã®ä¾‹(ã‚¢ã‚¤ãƒ†ãƒ ã‚ã‚Š)

    {
      Item: {
        productId: { S: 'P001' },
        category: { S: 'electronics' },
        name: { S: 'ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³' },
        price: { N: '3980' },
        stock: { N: '50' },
        createdAt: { S: '2024-01-15T00:00:00Z' },
      },
      ConsumedCapacity: undefined,
      $metadata: {
        requestId: 'XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX',
        httpStatusCode: 200,
        httpHeaders: { 'content-type': 'application/x-amz-json-1.0' },
        retryable: false,
      },
    }

    â–  result ã®ä¾‹(ã‚¢ã‚¤ãƒ†ãƒ ãªã—)

    {
      Item: undefined,
      ConsumedCapacity: undefined,
      $metadata: {
        requestId: 'XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX',
        httpStatusCode: 200,
        httpHeaders: { 'content-type': 'application/x-amz-json-1.0' },
        retryable: false,
      },
    }

- ENTRY:
  EXPLAIN: PutItemCommand å˜æ•°ä½œæˆ
  BODY: |
    â–  æ¦‚è¦

    ãƒ»æŒ‡å®šã—ãŸãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã§ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã€Œ1ä»¶ã€æ›¸ãè¾¼ã‚€
    ãƒ»åŒä¸€ã‚­ãƒ¼ãŒæ—¢ã«ã‚ã‚Œã°ä¸Šæ›¸ã(ç½®æ›)
    ãƒ»æ–°è¦ä½œæˆã¨ä¸Šæ›¸ãã®ä¸¡æ–¹ã«ä½¿ã†
    ãƒ»å­˜åœ¨æ™‚ã®ã¿ä¸Šæ›¸ã/æœªå­˜åœ¨æ™‚ã®ã¿ä½œæˆã—ãŸã„å ´åˆ ConditionExpression ã§åˆ¶å¾¡

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                        å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«åã¾ãŸã¯ ARN
    ãƒ»Item: Record<string, AttributeValue>     æ›¸ãè¾¼ã‚€ã‚¢ã‚¤ãƒ†ãƒ ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼å±æ€§ã¯å¿…ãšå«ã‚ã‚‹

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»ConditionExpression: string              æ¡ä»¶çœŸã®ã¨ãã ã‘ Put
                                               ä¾‹: attribute_not_exists(userId) ã§å­˜åœ¨ã—ãªã‘ã‚Œã°ä½œæˆ
    ãƒ»ExpressionAttributeNames: Record<string, string>
                                               å¼å†…ã®å±æ€§åãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€(#name)
    ãƒ»ExpressionAttributeValues: Record<string, AttributeValue>
                                               å¼å†…ã® :name ã®å€¤
    ãƒ»ReturnValues: string                     "NONE"(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ),"ALL_OLD","ALL_NEW"
    ãƒ»ReturnConsumedCapacity: string           "NONE","TOTAL","INDEXES"

    â–  æˆ»ã‚Šå€¤(PutItemCommandOutput)

    ãƒ»Attributes: Record<string, AttributeValue> | undefined
        ReturnValues æŒ‡å®šæ™‚ã®ã¿
        ALL_OLD ãªã‚‰ä¸Šæ›¸ãå‰ã€ALL_NEW ãªã‚‰æ›¸ãè¾¼ã¿å¾Œã®ã‚¢ã‚¤ãƒ†ãƒ 
    ãƒ»ConsumedCapacity: ConsumedCapacity | undefined
    ãƒ»ItemCollectionMetrics: ItemCollectionMetrics | undefined
    ãƒ»$metadata: ResponseMetadata

    â–  ã‚µãƒ³ãƒ—ãƒ«(ãƒ¦ãƒ¼ã‚¶1ä»¶ã‚’æŠ•å…¥)

    import { PutItemCommand } from '@aws-sdk/client-dynamodb';
    import { marshall } from '@aws-sdk/util-dynamodb';

    await client.send(new PutItemCommand({
      TableName: 'Users',
      Item: marshall({ userId: 'U001', name: 'ç”°ä¸­', createdAt: new Date().toISOString() }),
    }));

    â–  ã‚µãƒ³ãƒ—ãƒ«(å­˜åœ¨ã—ãªã„ã¨ãã ã‘ Put)

    await client.send(new PutItemCommand({
      TableName: 'Users',
      Item: marshall({ userId: 'U002', name: 'å±±ç”°' }),
      ConditionExpression: 'attribute_not_exists(userId)',
    }));

- ENTRY:
  EXPLAIN: UpdateItemCommand å˜æ•°æ›´æ–°/å˜æ•°ä½œæˆ
  BODY: |
    â–  æ¦‚è¦

    ãƒ»æŒ‡å®šã—ãŸãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®ã‚¢ã‚¤ãƒ†ãƒ ã®å±æ€§ã‚’éƒ¨åˆ†çš„ã«æ›´æ–°
    ãƒ»è©²å½“ã‚¢ã‚¤ãƒ†ãƒ ãŒç„¡ã„å ´åˆã¯æ–°è¦ä½œæˆ(upsert å‹•ä½œ)
    ãƒ»UpdateExpression ã§ SET / REMOVE / ADD / DELETE ã‚’æŒ‡å®š
    ãƒ»ConditionExpression ã§æ¡ä»¶ä»˜ãæ›´æ–°å¯èƒ½

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                           å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«åã¾ãŸã¯ ARN
    ãƒ»Key: Record<string, AttributeValue>         æ›´æ–°ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼
    ãƒ»UpdateExpression: string                    æ›´æ–°å†…å®¹ã€‚SET / REMOVE / ADD / DELETE å¥ã®çµ„ã¿åˆã‚ã›
        ä¾‹: SET #n = :val                         "#" ã¯ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹
            REMOVE unusedAttr                     "unusedAttr" ã¯å±æ€§å
            ADD score :inc                        ":inc" ã¯å¼å†…ã®å€¤
            DELETE tags :tagsToDel                ":tagsToDel" ã¯å¼å†…ã®å€¤

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»ExpressionAttributeNames: Record<string, string>
                                                  å±æ€§åã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€(#name)
    ãƒ»ExpressionAttributeValues: Record<string, AttributeValue>
                                                  å¼å†…ã® :name ã®å€¤
    ãƒ»ConditionExpression: string                 çœŸã®ã¨ãã ã‘æ›´æ–°
                                                  å½ãªã‚‰ ConditionalCheckFailedException
    ãƒ»ReturnValues: string                        æ›´æ–°å¾Œã®è¿”å´
                                                  "NONE","ALL_OLD","UPDATED_OLD","ALL_NEW","UPDATED_NEW"
    ãƒ»ReturnConsumedCapacity: string              "NONE","TOTAL","INDEXES"

    â–  æˆ»ã‚Šå€¤(UpdateItemCommandOutput)

    ãƒ»Attributes: Record<string, AttributeValue> | undefined
        ReturnValues æŒ‡å®šæ™‚ã®ã¿
        æŒ‡å®šå†…å®¹(ALL_OLD / UPDATED_OLD / ALL_NEW / UPDATED_NEW)ã®ã‚¢ã‚¤ãƒ†ãƒ 
    ãƒ»ConsumedCapacity: ConsumedCapacity | undefined
    ãƒ»ItemCollectionMetrics: ItemCollectionMetrics | undefined
        ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³(LSI ä»˜ããƒ†ãƒ¼ãƒ–ãƒ«)ã®ã‚µã‚¤ã‚ºæƒ…å ±
        ReturnItemCollectionMetrics æŒ‡å®šæ™‚ã®ã¿
    ãƒ»$metadata: ResponseMetadata

    â–  ã‚µãƒ³ãƒ—ãƒ«(ãƒ¦ãƒ¼ã‚¶ã® name ã‚’æ›´æ–°) â€» name ã¯äºˆç´„èª

    import { UpdateItemCommand } from '@aws-sdk/client-dynamodb';
    import { marshall } from '@aws-sdk/util-dynamodb';

    await client.send(new UpdateItemCommand({
      TableName: 'Users',
      Key: marshall({ userId: 'U001' }),
      UpdateExpression: 'SET #n = :name',           // ã‚¨ã‚¤ãƒªã‚¢ã‚¹ #n ã‚’ä½¿ã£ã¦ name ã‚’æ›´æ–°
      ExpressionAttributeNames: { '#n': 'name' },   // ã‚¨ã‚¤ãƒªã‚¢ã‚¹ #n = "name" ã¨æŒ‡å®š
      ExpressionAttributeValues: marshall({ ':name': 'æ–°ã—ã„åå‰' }),  // æ›´æ–°å€¤æŒ‡å®š
    }));

    â–  ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã€Œ#nã€ã®ä½¿ã„æ–¹(ExpressionAttributeNames)

    ãƒ»UpdateExpression / ConditionExpression / KeyConditionExpression ãªã©ã§ã¯
      å±æ€§åã‚’ãã®ã¾ã¾æ›¸ã‘ã‚‹ãŒã€äºˆç´„èªã‚„ç‰¹æ®Šæ–‡å­—ã‚’å«ã‚€å±æ€§åã¯ä½¿ãˆãªã„
    ãƒ»ã€Œ#ã€ã§å§‹ã¾ã‚‹ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€(ä¾‹: #n, #nm, #attr)ã‚’å¼ã®ä¸­ã«æ›¸ãã€
      ExpressionAttributeNames ã§ã€Œãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ â†’ å®Ÿéš›ã®å±æ€§åã€ã‚’å¯¾å¿œ
      ãƒ»å±æ€§åãŒ name: UpdateExpression ã« "name" ã¨ç›´æ¥æ›¸ãã¨äºˆç´„èªã§ã‚¨ãƒ©ãƒ¼
        ãã®ãŸã‚ã€#n = :val ã¨ã— ExpressionAttributeNames: { '#n': 'name' } ã‚’æ¸¡ã™
      ãƒ»ã€Œ:ã€ã§å§‹ã¾ã‚‹åå‰(ä¾‹ã€:name, :val) ã¯ ExpressionAttributeValues ç”¨ã®å€¤ã‚¨ã‚¤ãƒªã‚¢ã‚¹
        å±æ€§ã€Œåã€ã¯ #ã€å€¤ã¯ : ã§åŒºåˆ¥
    ãƒ»åŒã˜å¼å†…ã§è¤‡æ•°å±æ€§ã‚’æ‰±ã†ã¨ãã¯ #n, #c ãªã©åˆ¥ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã‚’ä»˜ã‘ã€
      ExpressionAttributeNames ã«ãã‚Œãã‚Œå®šç¾©ã™ã‚‹

    â–  ã‚µãƒ³ãƒ—ãƒ«(å•†å“ã®åœ¨åº«ã‚’æ¸›ç®—ãƒ»æ¡ä»¶ä»˜ã)

    await client.send(new UpdateItemCommand({
      TableName: 'Products',
      Key: marshall({ productId: 'P001', category: 'electronics' }),
      UpdateExpression: 'SET stock = stock - :qty',          // stock ã¯éäºˆç´„èªãªã®ã§ã‚¨ã‚¤ãƒªã‚¢ã‚¹ä¸è¦
      ConditionExpression: 'stock >= :qty',
      ExpressionAttributeValues: marshall({ ':qty': 1 }),
      ReturnValues: 'ALL_NEW',
    }));

- ENTRY:
  EXPLAIN: DeleteItemCommand å˜æ•°å‰Šé™¤
  BODY: |
    â–  æ¦‚è¦

    ãƒ»æŒ‡å®šã—ãŸãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’1ä»¶å‰Šé™¤
    ãƒ»è©²å½“ã‚¢ã‚¤ãƒ†ãƒ ãŒç„¡ã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãšæ­£å¸¸çµ‚äº†
    ãƒ»ConditionExpression ã§æ¡ä»¶ä»˜ãå‰Šé™¤å¯èƒ½ï¼ˆå½ãªã‚‰ ConditionalCheckFailedExceptionï¼‰

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                           å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«åã¾ãŸã¯ ARN
    ãƒ»Key: Record<string, AttributeValue>         å‰Šé™¤ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»ConditionExpression: string                 çœŸã®ã¨ãã ã‘å‰Šé™¤
    ãƒ»ExpressionAttributeNames: Record<string, string>
    ãƒ»ExpressionAttributeValues: Record<string, AttributeValue>
    ãƒ»ReturnValues: string                        "NONE"(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ),"ALL_OLD"
    ãƒ»ReturnConsumedCapacity: string              "NONE","TOTAL","INDEXES"

    â–  æˆ»ã‚Šå€¤(DeleteItemCommandOutput)

    ãƒ»Attributes: Record<string, AttributeValue> | undefined
        ReturnValues: "ALL_OLD" æŒ‡å®šæ™‚ã®ã¿ã€‚å‰Šé™¤å‰ã®ã‚¢ã‚¤ãƒ†ãƒ 
    ãƒ»ConsumedCapacity: ConsumedCapacity | undefined
    ãƒ»$metadata: ResponseMetadata

    â–  ã‚µãƒ³ãƒ—ãƒ«(ãƒ¦ãƒ¼ã‚¶1ä»¶å‰Šé™¤)

    import { DeleteItemCommand } from '@aws-sdk/client-dynamodb';
    import { marshall } from '@aws-sdk/util-dynamodb';

    await client.send(new DeleteItemCommand({
      TableName: 'Users',
      Key: marshall({ userId: 'U001' }),
    }));

    â–  ã‚µãƒ³ãƒ—ãƒ«(æ¡ä»¶ä»˜ãå‰Šé™¤ãƒ»å­˜åœ¨ã™ã‚‹ã¨ãã ã‘)

    await client.send(new DeleteItemCommand({
      TableName: 'Users',
      Key: marshall({ userId: 'U001' }),
      ConditionExpression: 'attribute_exists(userId)',
      ReturnValues: 'ALL_OLD',
    }));

- ENTRY:
  EXPLAIN: ScanCommand å…¨ä»¶å–å¾—
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«(ã¾ãŸã¯ GSI)ã®å…¨ã‚¢ã‚¤ãƒ†ãƒ ã‚’èµ°æŸ»
    ãƒ»ã‚­ãƒ¼æ¡ä»¶ãªã—
    ãƒ»Query ã¨é•ã„ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼æŒ‡å®šãŒä¸è¦
    ãƒ»å…¨ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’èª­ã‚€ãŸã‚ RCU æ¶ˆè²»ãŒå¤§ãã„
    ãƒ»FilterExpression ã§å–å¾—å¾Œã«ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½(è©•ä¾¡ã—ãŸã‚¢ã‚¤ãƒ†ãƒ æ•°ã¯ ScannedCountã€è¿”å´æ•°ã¯ Count)
    ãƒ»1å›ã®æˆ»ã‚Š(çµæœã‚»ãƒƒãƒˆ)ã¯æœ€å¤§ 1MB
    ãƒ»LastEvaluatedKey ã§ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³

    ãƒ»çµæœã¨ã—ã¦è¿”ã™ã‚‚ã®

      ãƒ»Items: èµ°æŸ»ã§ãƒ’ãƒƒãƒˆã—ãŸã‚¢ã‚¤ãƒ†ãƒ ã®é…åˆ—(Query ã¨åŒæ§˜ã®å½¢)
      ãƒ»Count: Filter é©ç”¨å¾Œã®è¿”å´æ•°ã€‚ScannedCount: è©•ä¾¡ã—ãŸã‚¢ã‚¤ãƒ†ãƒ æ•°
      ãƒ»LastEvaluatedKey: ç¶šããŒã‚ã‚‹ã¨ãã®ã¿ã€‚ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ç”¨

    ãƒ»Query ã¨ã®é•ã„

      ãƒ»Query: 1ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼(+ã‚½ãƒ¼ãƒˆã‚­ãƒ¼æ¡ä»¶)ã‚’æŒ‡å®šã—ã€ãã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³å†…ã®ã‚¢ã‚¤ãƒ†ãƒ ã ã‘å–å¾—
      ãƒ»Scan: ã‚­ãƒ¼æ¡ä»¶ã‚’æŒ‡å®šã—ãªã„ã€‚å…¨ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’èª­ã‚“ã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«(ã¾ãŸã¯ GSI)å…¨ä½“ã‹ã‚‰ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿”ã™
      ãƒ»æˆ»ã‚Šå€¤ã®å½¢(Items, Count, LastEvaluatedKey)ã¯ä¼¼ã¦ã„ã‚‹ãŒã€å–å¾—ç¯„å›²ãŒã€Œ1ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã€ã‹ã€Œãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã€ã‹ãŒé•ã†

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»TableName: string                           å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«åã¾ãŸã¯ãƒ†ãƒ¼ãƒ–ãƒ« ARN

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»FilterExpression: string                    å–å¾—å¾Œã«é©ç”¨ã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿
    ãƒ»ExpressionAttributeNames: Record<string, string>
    ãƒ»ExpressionAttributeValues: Record<string, AttributeValue>
    ãƒ»IndexName: string                           ã‚¹ã‚­ãƒ£ãƒ³å¯¾è±¡ã® GSI å(LSI ã‚‚æŒ‡å®šå¯)
    ãƒ»Limit: number                               è©•ä¾¡ã™ã‚‹æœ€å¤§ã‚¢ã‚¤ãƒ†ãƒ æ•°
    ãƒ»ExclusiveStartKey: Record<string, AttributeValue>
                                                  å‰å›ã® LastEvaluatedKey
    ãƒ»Segment: number / TotalSegments: number     ä¸¦åˆ—ã‚¹ã‚­ãƒ£ãƒ³ç”¨(0 ï½ TotalSegments-1 ã® Segment ã‚’å‰²å½“)
    ãƒ»ProjectionExpression: string                è¿”å´ã™ã‚‹å±æ€§ã®ãƒªã‚¹ãƒˆ
    ãƒ»ConsistentRead: boolean                     true ã§å¼·åŠ›æ•´åˆæ€§(GSI ã§ã¯ä¸å¯)
    ãƒ»ReturnConsumedCapacity: string              "NONE","TOTAL","INDEXES"

    â–  æˆ»ã‚Šå€¤(ScanCommandOutput)

    ãƒ»Items: Item[]                               å–å¾—ã—ãŸã‚¢ã‚¤ãƒ†ãƒ ã®é…åˆ—
    ãƒ»Count: number                               Filter é©ç”¨å¾Œã®è¿”å´æ•°
    ãƒ»ScannedCount: number                        è©•ä¾¡ã—ãŸã‚¢ã‚¤ãƒ†ãƒ æ•°
    ãƒ»LastEvaluatedKey: Record<string, AttributeValue> | undefined  ç¶šããŒã‚ã‚‹ã¨ãã®ã¿
    ãƒ»ConsumedCapacity: ConsumedCapacity | undefined
    ãƒ»$metadata: ResponseMetadata

    â–  ã‚µãƒ³ãƒ—ãƒ«(å…¨ä»¶ã‚¹ã‚­ãƒ£ãƒ³)

    import { ScanCommand } from '@aws-sdk/client-dynamodb';
    import { marshall, unmarshall } from '@aws-sdk/util-dynamodb';

    const result = await client.send(new ScanCommand({
      TableName: 'Users',
    }));

    â–  ã‚µãƒ³ãƒ—ãƒ«(FilterExpression + ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³)

    let lastKey: Record<string, unknown> | undefined;
    const items: unknown[] = [];
    do {
      const result = await client.send(new ScanCommand({
        TableName: 'Users',
        FilterExpression: 'attribute_exists(#n)',
        ExpressionAttributeNames: { '#n': 'name' },
        ExclusiveStartKey: lastKey,
      }));
      items.push(...(result.Items ?? []).map((i) => unmarshall(i)));
      lastKey = result.LastEvaluatedKey as Record<string, unknown> | undefined;
    } while (lastKey);

- ENTRY:
  EXPLAIN: BatchWriteItemCommand
  BODY: |
    â–  æ¦‚è¦

    ãƒ»PutItem / DeleteItem ã‚’è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»è¤‡æ•°ã‚¢ã‚¤ãƒ†ãƒ ã§ä¸€æ‹¬é€ä¿¡
    ãƒ»1ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ãŸã‚Š 25 ä»¶ã¾ã§(Put + Delete ã®åˆè¨ˆ)
    ãƒ»1ã‚¢ã‚¤ãƒ†ãƒ  400KB åˆ¶é™ã€‚è¶…éåˆ†ã¯ UnprocessedItems ã§è¿”ã‚‹
    ãƒ»ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ç­‰ã§å‡¦ç†ã•ã‚Œãªã‹ã£ãŸåˆ†ã‚‚ UnprocessedItems ã«å«ã¾ã‚Œã‚‹

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»RequestItems: Record<string, WriteRequest[]>
        ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ã‚­ãƒ¼ã€WriteRequest ã®é…åˆ—ã‚’å€¤
        WriteRequest: { PutRequest: { Item } } ã¾ãŸã¯ { DeleteRequest: { Key } }

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»ReturnConsumedCapacity: string              "NONE","TOTAL","INDEXES"
    ãƒ»ReturnItemCollectionMetrics: string

    â–  æˆ»ã‚Šå€¤(BatchWriteItemCommandOutput)

    ãƒ»UnprocessedItems: Record<string, WriteRequest[]>
        å‡¦ç†ã•ã‚Œãªã‹ã£ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¯¾å¿œ
    ãƒ»ConsumedCapacity: ConsumedCapacity[]
    ãƒ»ItemCollectionMetrics: Record<string, ItemCollectionMetrics[]>[]
    ãƒ»$metadata: ResponseMetadata

    â–  ã‚µãƒ³ãƒ—ãƒ«(è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã« Put + Delete)

    import { BatchWriteItemCommand } from '@aws-sdk/client-dynamodb';
    import { marshall } from '@aws-sdk/util-dynamodb';

    await client.send(new BatchWriteItemCommand({
      RequestItems: {
        Users: [
          { PutRequest: { Item: marshall({ userId: 'U001', name: 'ç”°ä¸­' }) } },
          { PutRequest: { Item: marshall({ userId: 'U002', name: 'å±±ç”°' }) } },
        ],
        Products: [
          { DeleteRequest: { Key: marshall({ productId: 'P001', category: 'electronics' }) } },
        ],
      },
    }));

- ENTRY:
  EXPLAIN: BatchGetItemCommand
  BODY: |
    â–  æ¦‚è¦

    ãƒ»è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰è¤‡æ•°ã‚­ãƒ¼ã§ä¸€æ‹¬å–å¾—(GetItem ã‚’ã¾ã¨ã‚ãŸã‚¤ãƒ¡ãƒ¼ã‚¸)
    ãƒ»1ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ãŸã‚Š 100 ä»¶ã¾ã§(ã‚­ãƒ¼æ•°)
    ãƒ»è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã«åˆ†æ•£å¯èƒ½
    ãƒ»å„ã‚­ãƒ¼ã¯1ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç‰¹å®š
    ãƒ»åŒä¸€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«é™å®šã•ã‚Œãªã„
    ãƒ»æœªå‡¦ç†åˆ†ã¯ UnprocessedKeys ã§è¿”ã‚Šã€ãƒªãƒˆãƒ©ã‚¤ã™ã‚‹

    â–  å¼•æ•°(å¿…é ˆ)

    ãƒ»RequestItems: Record<string, KeysAndAttributes>
        ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ã‚­ãƒ¼ã€KeysAndAttributes ã‚’å€¤
        KeysAndAttributes: { Keys: Record<string, AttributeValue>[] }

    â–  å¼•æ•°(ä»»æ„)

    ãƒ»KeysAndAttributes å†…
      ãƒ»ProjectionExpression: string
      ãƒ»ExpressionAttributeNames: Record<string, string>
    ãƒ»ReturnConsumedCapacity: string   "NONE","TOTAL","INDEXES"

    â–  æˆ»ã‚Šå€¤(BatchGetItemCommandOutput)

    ãƒ»Responses: Record<string, Record<string, AttributeValue>[]>
        ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’ã‚­ãƒ¼ã€å–å¾—ã—ãŸã‚¢ã‚¤ãƒ†ãƒ ã®é…åˆ—ã‚’å€¤
    ãƒ»UnprocessedKeys: Record<string, KeysAndAttributes>
        ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ç­‰ã§æœªå‡¦ç†ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã‚­ãƒ¼
    ãƒ»ConsumedCapacity: ConsumedCapacity[]
    ãƒ»$metadata: ResponseMetadata

    â–  ã‚µãƒ³ãƒ—ãƒ«(è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ä¸€æ‹¬å–å¾—)

    import { BatchGetItemCommand } from '@aws-sdk/client-dynamodb';
    import { marshall, unmarshall } from '@aws-sdk/util-dynamodb';

    const result = await client.send(new BatchGetItemCommand({
      RequestItems: {
        Users: { Keys: [ marshall({ userId: 'U001' }), marshall({ userId: 'U002' }) ] },
        Products: { Keys: [ marshall({ productId: 'P001', category: 'electronics' }) ] },
      },
    }));

    const users = (result.Responses?.Users ?? []).map((i) => unmarshall(i));
    const products = (result.Responses?.Products ?? []).map((i) => unmarshall(i));

- ENTRY:
  EXPLAIN: é¡ä¼¼ãƒ¡ã‚½ãƒƒãƒ‰ã®ä½¿ã„åˆ†ã‘
  BODY: |
    â–  QueryCommand & BatchGetItemCommand ã®ä½¿ã„åˆ†ã‘

    ãƒ»åŒä¸€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã®ç¯„å›²å–å¾—ãƒ»ã‚½ãƒ¼ãƒˆã‚­ãƒ¼æ¡ä»¶ â†’ QueryCommand
    ãƒ»è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚„ãƒãƒ©ãƒãƒ©ã®ã‚­ãƒ¼ã‚’ã¾ã¨ã‚ã¦å–å¾— â†’ BatchGetItemCommand

    â–  QueryCommand

    ãƒ»åŒä¸€ãƒ†ãƒ¼ãƒ–ãƒ«(ã¾ãŸã¯ LSI/GSI)ã«å¯¾ã—ã€1ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼(+ã‚½ãƒ¼ãƒˆã‚­ãƒ¼æ¡ä»¶)ã§"ãã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³å†…"ã®è¤‡æ•°ã‚¢ã‚¤ãƒ†ãƒ ã‚’å–å¾—
    ãƒ»ã‚­ãƒ¼æ¡ä»¶ã§ç¯„å›²æŒ‡å®šå¯èƒ½(BETWEEN, <, > ç­‰)
    ãƒ»1å›ã‚ãŸã‚Šæœ€å¤§ 1MBã€LastEvaluatedKey ã§ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³

    â–  BatchGetItemCommand

    ãƒ»è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æŒ‡å®šå¯èƒ½
    ãƒ»å„ãƒ†ãƒ¼ãƒ–ãƒ«ã«"å–å¾—ã—ãŸã„ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®ãƒªã‚¹ãƒˆ"ã‚’æ¸¡ã—ã€ãƒãƒ©ãƒãƒ©ã®ã‚­ãƒ¼ã§è¤‡æ•°ã‚¢ã‚¤ãƒ†ãƒ ã‚’ä¸€æ‹¬å–å¾—
    ãƒ»å„ã‚­ãƒ¼ã¯1ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç‰¹å®š(GetItem ã‚’è¤‡æ•°ã¾ã¨ã‚ãŸã‚¤ãƒ¡ãƒ¼ã‚¸)
    ãƒ»åŒä¸€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³é™å®šã§ã¯ãªã„

#-------------------------------
# @aws-sdk/util-dynamodb
#-------------------------------

- ENTRY:
  CATEGORY: |
    @aws-sdk/util-dynamodb

- ENTRY:
  EXPLAIN: ãƒªã‚¹ãƒˆ
  BODY: |
    â–  marshall

      ãƒ»JavaScript ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ DynamoDB ã® AttributeValue å½¢å¼ã«å¤‰æ›
      ãƒ»Item / Key / ExpressionAttributeValues ç­‰ã«ä½¿ç”¨

    â–  unmarshall

      ãƒ»DynamoDB ã® AttributeValue å½¢å¼ã‚’ JavaScript ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
      ãƒ»GetItem / Query / Scan ã®æˆ»ã‚Šã‚’æ‰±ã†ã¨ãã«ä½¿ç”¨

    â–  convertToAttr

      ãƒ»å˜ä¸€ã® JavaScript å€¤ã‚’ 1 ã¤ã® AttributeValue ã«å¤‰æ›
      ãƒ»marshall ã®å˜ä¸€å€¤ç‰ˆ

    â–  convertToNative

      ãƒ»å˜ä¸€ã® AttributeValue ã‚’ JavaScript å€¤ã«å¤‰æ›
      ãƒ»unmarshall ã®å˜ä¸€å€¤ç‰ˆ

- ENTRY:
  EXPLAIN: marshall & unmarshall
  BODY: |
    â–  æ¦‚è¦

    ãƒ»client-dynamodb ã® API ã¯ AttributeValue å½¢å¼(S/N/B/M/L ç­‰)ã§ã‚„ã‚Šå–ã‚Šã™ã‚‹
    ãƒ»marshall ã§ JS ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ â†’ AttributeValueã€unmarshall ã§ AttributeValue â†’ JS ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¦æ‰±ã„ã‚„ã™ãã™ã‚‹

    â–  marshall

    ãƒ»å¼•æ•°: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ(ã¾ãŸã¯é…åˆ—)
    ãƒ»æˆ»ã‚Š: Record<string, AttributeValue> å½¢å¼
          string â†’ { S }
          number â†’ { N }(æ–‡å­—åˆ—)
          boolean â†’ { BOOL }
          Array â†’ { L }/{ SS }/{ NS }/{ BS }(å‹ã«å¿œã˜ã‚‹)
    ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³: convertEmptyValues, removeUndefinedValues ç­‰ã§ç©ºæ–‡å­—ãƒ»undefined ã®æ‰±ã„ã‚’å¤‰æ›´å¯èƒ½

    â–  unmarshall

    ãƒ»å¼•æ•°: Record<string, AttributeValue>
    ãƒ»æˆ»ã‚Š: é€šå¸¸ã® JS ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
    ãƒ»GetItem / Query / Scan ã® Item ã‚„ Items ã‚’ãã®ã¾ã¾æ¸¡ã—ã¦ TS ã§æ‰±ã†å½¢ã«å¤‰æ›ã§ãã‚‹

    â–  ã‚µãƒ³ãƒ—ãƒ«(marshall ã§ Item æŠ•å…¥)

    import { marshall } from '@aws-sdk/util-dynamodb';

    const item = marshall({
      userId: 'U001',
      name: 'ç”°ä¸­',
      score: 100,
      tags: ['front', 'back'],
    });
    // => { userId: { S: 'U001' }, name: { S: 'ç”°ä¸­' }, score: { N: '100' }, tags: { SS: ['front', 'back'] } }

    â–  ã‚µãƒ³ãƒ—ãƒ«(GetItem ã®æˆ»ã‚Šã‚’ unmarshall)

    import { unmarshall } from '@aws-sdk/util-dynamodb';

    const result = await client.send(new GetItemCommand({ TableName: 'Users', Key: marshall({ userId: 'U001' }) }));
    const user = result.Item ? unmarshall(result.Item) : null;

- ENTRY:
  EXPLAIN: convertToAttr & convertToNative
  BODY: |
    â–  æ¦‚è¦

    ãƒ»1 å±æ€§åˆ†ã ã‘å¤‰æ›ã—ãŸã„ã¨ãã«ä½¿ç”¨
    ãƒ»marshall / unmarshall ã®å˜ä¸€å€¤ç‰ˆ
    ãƒ»å¼ã®ä¸­ã§ä½¿ã†å€¤ã‚„ã€1 ã¤ã® AttributeValue ã ã‘ã‚’ JS ã¨ç›¸äº’å¤‰æ›ã™ã‚‹ç”¨é€”å‘ã‘

    â–  convertToAttr

      ãƒ»å¼•æ•°: å˜ä¸€ã® JS å€¤(string / number / boolean / null / Array / object ç­‰)
      ãƒ»æˆ»ã‚Š: 1 ã¤ã® AttributeValue
      
      ãƒ»ä¾‹: convertToAttr('hello') => { S: 'hello' }ã€convertToAttr(100) => { N: '100' }

    â–  convertToNative

      ãƒ»å¼•æ•°: 1 ã¤ã® AttributeValue
      ãƒ»æˆ»ã‚Š: å¯¾å¿œã™ã‚‹ JS å€¤
      
      ãƒ»ä¾‹: convertToNative({ S: 'hello' }) => 'hello'ã€convertToNative({ N: '100' }) => 100

    â–  ã‚µãƒ³ãƒ—ãƒ«(convertToAttr)

    import { convertToAttr } from '@aws-sdk/util-dynamodb';

    const attr = convertToAttr('value');
    // => { S: 'value' }

    â–  ã‚µãƒ³ãƒ—ãƒ«(convertToNative)

    import { convertToNative } from '@aws-sdk/util-dynamodb';

    const val = convertToNative({ N: '42' });
    // => 42

#-------------------------------
# ãã®ä»–
#-------------------------------

- ENTRY:
  CATEGORY: ãã®ä»–

- ENTRY:
  EXPLAIN: åˆ†å²ãƒ¡ã‚½ãƒƒãƒ‰
  BODY: |
    â–  æ¦‚è¦

    ãƒ»ConditionExpression / FilterExpression ã§ä½¿ãˆã‚‹çµ„ã¿è¾¼ã¿é–¢æ•°ä¸€è¦§
    ãƒ»å¼å†…ã§ã¯å±æ€§åã«äºˆç´„èªãŒã‚ã‚Œã° #name
    ãƒ»å€¤ã¯ :val ã§ ExpressionAttributeNames / ExpressionAttributeValues ã‚’æ¸¡ã™

    â–  attribute_exists(path)

    ãƒ»æŒ‡å®šã—ãŸãƒ‘ã‚¹ã«å±æ€§ãŒå­˜åœ¨ã™ã‚‹ã¨ã true

    ãƒ»ä¾‹: userId ãŒå­˜åœ¨ã™ã‚‹ã¨ãã ã‘å‰Šé™¤ã™ã‚‹æ¡ä»¶

      ConditionExpression: 'attribute_exists(userId)',

    â–  attribute_not_exists(path)

    ãƒ»æŒ‡å®šã—ãŸãƒ‘ã‚¹ã«å±æ€§ãŒå­˜åœ¨ã—ãªã„ã¨ã true

    ãƒ»ä¾‹: userId ãŒå­˜åœ¨ã—ãªã„ã¨ãã ã‘æ›¸ãè¾¼ã‚€æ¡ä»¶

      ConditionExpression: 'attribute_not_exists(userId)',

    â–  attribute_type(path, type)

    ãƒ»å±æ€§ã®å‹ãŒ type ã®ã¨ã true
    ãƒ»type ã¯ S, N, B, SS, NS, BS, BOOL, NULL, L, M ã®ã„ãšã‚Œã‹(å¼ã§ã¯ :t ç­‰ã§æ¸¡ã™)

    ãƒ»ä¾‹: name ãŒæ–‡å­—åˆ—å‹(S)ã‹

      ConditionExpression: 'attribute_type(#n, :t)',
      ExpressionAttributeNames: { '#n': 'name' },
      ExpressionAttributeValues: marshall({ ':t': 'S' }),

    â–  begins_with(path, substr)

    ãƒ»æ–‡å­—åˆ—å±æ€§ãŒ substr ã§å§‹ã¾ã‚‹ã¨ã true

    ãƒ»ä¾‹: userId ãŒ "USER_" ã§å§‹ã¾ã‚‹ã¨ã

      ConditionExpression: 'begins_with(userId, :prefix)',
      ExpressionAttributeValues: marshall({ ':prefix': 'USER_' }),

    â–  contains(path, operand)

    ãƒ»æ–‡å­—åˆ—ãªã‚‰éƒ¨åˆ†æ–‡å­—åˆ—ã‚’å«ã‚€ã¨ã true
    ãƒ»Set(String Set / Number Set / Binary Set)ãªã‚‰æŒ‡å®šè¦ç´ ã‚’å«ã‚€ã¨ã true
    ãƒ»List ãªã‚‰æŒ‡å®šè¦ç´ ã‚’å«ã‚€ã¨ã trueã€‚ã„ãšã‚Œã‚‚ path ã®å‹ã§æŒ™å‹•ãŒæ±ºã¾ã‚‹

    ãƒ»ä¾‹: role ãŒ "admin" ã‚’å«ã‚€ã‹(æ–‡å­—åˆ—ã®éƒ¨åˆ†ä¸€è‡´)

      ConditionExpression: 'contains(#r, :v)',
      ExpressionAttributeNames: { '#r': 'role' },
      ExpressionAttributeValues: marshall({ ':v': 'admin' }),

    ãƒ»ä¾‹: colors(SS) ãŒ "red" ã‚’è¦ç´ ã«å«ã‚€ã‹

      ConditionExpression: 'contains(colors, :v)',
      ExpressionAttributeValues: marshall({ ':v': 'red' }),

    â–  size(path)

    ãƒ»æ–‡å­—åˆ—ã®é•·ã•ã€ãƒã‚¤ãƒŠãƒªã®ãƒã‚¤ãƒˆæ•°ã€Set/List/Map ã®è¦ç´ æ•°ã‚’è¿”ã™
    ãƒ»æ¯”è¼ƒæ¼”ç®—å­ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ã†

    ãƒ»ä¾‹: name ã®æ–‡å­—åˆ—é•·ãŒ 10 ä»¥ä¸‹

      ConditionExpression: 'size(#n) <= :max',
      ExpressionAttributeNames: { '#n': 'name' },
      ExpressionAttributeValues: marshall({ ':max': 10 }),
