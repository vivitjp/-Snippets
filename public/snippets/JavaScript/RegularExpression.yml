---
#-------------------------------
# JavaScript: RegularExpression
#-------------------------------

- KEY: reg.RegExp
  EXPLAIN: æ­£è¦è¡¨ç¾
  BODY: |
    const regexp = new RegExp( pattern[, flags] )

    const target = 'ABCDEFG';

    const regexp = /DEF/ig;
    regexp.test(target);       //true
    regexp.compile(target);    //Deprecated

    //ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¸ã®ãƒ‘ãƒ©ãƒ¡ã‚¿
    const regexp = new RegExp('DEF', 'ig');
    regexp.test(target);       //true

- KEY: reg.captureGroup
  EXPLAIN: åå‰ä»˜ãã‚­ãƒ£ãƒ—ãƒãƒ£ã‚°ãƒ«ãƒ¼ãƒ—
  BODY: |
    const target = '123 456 789';
    const regexp = /(?<first>[0-9]+)\s(?<second>[0-9]+)/u;

    const hits = regexp.exec(target);  //gãƒ•ãƒ©ã‚°ã¨ã®ç›¸æ€§OK
    hits.groups.first;                 //'123'
    hits.groups.second;                //'456'

    const hits = target.match(regexp); //gãƒ•ãƒ©ã‚°ã¨ã®ç›¸æ€§æ‚ªã—
    hits.groups.first;                 //'123'
    hits.groups.second;                //'456'

- KEY: reg.exec()
  EXPLAIN: ä¸€è‡´æ–‡å­—åˆ—å–å¾—
  BODY: |
    const target = '123 456 789';
    const regexp = /[0-9]+/g;

    //å®Ÿè¡Œã™ã‚‹åº¦ã«å†…éƒ¨indexãŒç§»å‹•
    let hit = regexp.exec(target);  // ["123"]
    hit = regexp.exec(target);      // ["456"] 
    hit = regexp.exec(target);      // ["789"]
    hit = regexp.exec(target);      // null

    while(hit = regexp.exec(target)){ //ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚‚ã©ã
      hit;                          //["123"],["456"],["789"]
      regexp.lastIndex;             //3,7,11
    }

- KEY: reg.test()
  EXPLAIN: ä¸€è‡´:boolean
  BODY: |
    const target = 'table cable maple';
    const regexp = new RegExp('ab*', 'g');

    //å®Ÿè¡Œã™ã‚‹åº¦ã«å†…éƒ¨indexãŒç§»å‹•
    regexp.lastIndex;         //0
    regexp.test(target);      //true
    regexp.lastIndex;         //3
    regexp.test(target);      //false

- KEY: reg.match()
  EXPLAIN: ä¸€è‡´:å€¤
  BODY: |
    const target = "123 456 789";
    const regexp = /[0-9]+/g;

    let hit = target.match(regexp);      //['123','456','789']

- KEY: reg.str.matchAll2022
  EXPLAIN: String2022ã§ã®ä¸€è‡´
  BODY: |
    const target = 'test1 test2';
    const regexp = /t(e)(st(\d?))/g;

    const array = [...target.matchAll(regexp)];
    array[0];     //["test1", "e", "st1", "1"]
    array[1];     //["test2", "e", "st2", "2"]

    const target = 'table football, foosball';
    const regexp = RegExp('foo[a-z]*','g');

    const hits = target.matchAll(regexp);
    console.log(hits);             //{} ç©ºãªã®ã§è¦æ³¨æ„
    for (const hit of hits) {      //å®Ÿéš›ã«ã¯å­˜åœ¨
      let idx = hit.index;
      console.log(`${hit[0]}: ${idx}~${idx + hit[0].length - 1}`);
    }

    const res = Array.from(target.matchAll(regexp), m => m[0]);
    //["football", "foosball"]

- KEY: reg.flags
  EXPLAIN: ãƒ•ãƒ©ã‚°
  BODY: |
    g  global(è¤‡æ•°ãƒãƒƒãƒ)
    i  ignoreCase(å¤§å°æ–‡å­—åŒºåˆ¥ãªã—)
    m  multiline(è¤‡æ•°è¡Œæ¤œç´¢)
    u  unicode(ã‚µãƒ­ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒšã‚¢ã‚’1æ–‡å­—ã¨ã—ã¦æ‰±ã†)
    y  sticky(lastIndexã§æŒ‡å®šã—ãŸä½ç½®ã‹ã‚‰æ¤œç´¢)
    s  dotAll([.]ãŒCR,LF,U+2028,U+2029ãªã©å…¨æ–‡å­—ãƒãƒƒãƒ)

- KEY: reg.flag.m
  EXPLAIN: æ”¹è¡Œã‚’è¡Œé ­è¡Œæœ«èªè­˜
  BODY: |
    è¡Œé ­(^)ã‚„è¡Œæœ«($)ãŒã€æ”¹è¡Œ(\n)å¾Œã®è¡Œé ­è¡Œæœ«ã«ã‚‚ãƒãƒƒãƒãƒ³ã‚°

    const target = 'ABC\nDEF\nGHI';
    target.match(/ABC$/);        //null
    target.match(/ABC$/m);       //["ABC"]
    target.match(/^DEF/);        //null
    target.match(/^DEF/m);       //["DEF"]
    target.match(/^DEF$/);       //null
    target.match(/^DEF$/m);      //["DEF"]

- KEY: reg.flag.u
  EXPLAIN: ã‚µãƒ­ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒšã‚¢
  BODY: |
    U+10000ä»¥ä¸Šã®ã‚µãƒ­ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒšã‚¢é ˜åŸŸã®æ–‡å­—ã‚‚1æ–‡å­—

    console.log('ğŸ§²'.match(/^.$/));  //null (2æ–‡å­—ã ã‹ã‚‰)
    console.log('ğŸ§²'.match(/^.$/u)); //uãƒ•ãƒ©ã‚°(1æ–‡å­—ã¨ã—ã¦ä¸€è‡´)

- KEY: reg.flag.y
  EXPLAIN: lastIndexä½ç½®å›ºå®š
  BODY: |
    yãƒ•ãƒ©ã‚°: lastIndex ã®ä½ç½®ã‹ã‚‰ã‹ã‚‰å…ˆé ­ãƒãƒƒãƒãƒ³ã‚°ã§ä½ç½®ã‚’å›ºå®š(lastIndexãŒå…ˆã«é€²ã¾ãªã„)ã€‚
    gã‚’ã¤ã‘ã¦ã‚‚çµæœã¯ä¸€ã¤ã€‚æŒ™å‹•è¦æ³¨æ„

    const target = '123 456 789';
    const regexp = /[0-9]+/gy;   //gãƒ•ãƒ©ã‚° + yãƒ•ãƒ©ã‚°
    regexp.lastIndex = 7;        //lastIndexæŒ‡å®š(ä½ç½®å›ºå®š)

    let hit= null;
    hit= regexp.exec(target)
    console.log(hit, regexp.lastIndex);
    hit= regexp.exec(target)
    console.log(hit, regexp.lastIndex);
    hit= regexp.exec(target)
    console.log(hit, regexp.lastIndex);
    hit= regexp.exec(target)
    console.log(hit, regexp.lastIndex);

- KEY: reg.flag.s
  EXPLAIN: ãƒ‰ãƒƒãƒˆã‚’æ”¹è¡Œã«ã‚‚ä¸€è‡´
  BODY: |
    //.(ãƒ‰ãƒƒãƒˆ)ã‚’æ”¹è¡Œæ–‡å­—ã«ã‚‚ä¸€è‡´
    const target = "ABC\nDEF\nGHI";
    const regexp = /.+/g;             //No sãƒ•ãƒ©ã‚°
    for (const hit of target.matchAll(regexp)) {
      console.log(hit, hit.index);    // ["ABC"],0 | ["DEF"],4 | ["GHI"],8 
    }

    const regexp = /.+/gs;           //sãƒ•ãƒ©ã‚°
    for (const hit of target.matchAll(regexp)) {
      console.log(hit, hit.index);   // [""ABC\nDEF\nGHI""] 0
    }

- KEY: reg.matching
  EXPLAIN: ãƒãƒƒãƒãƒ³ã‚°è¡¨ç¾
  BODY: |
    x        xã¨ã„ã†æ–‡å­—
    xyz      å˜èªãƒãƒƒãƒ
    [xyz]    []å†…1æ–‡å­—
    [x-z]    xï½zã®1æ–‡å­—
    [^xyz]   x,y,zä»¥å¤–ã®1æ–‡å­—
    .        ä»»æ„ã®1æ–‡å­—(ä»¥ä¸‹ä»¥å¤–)
              Line Feed(\n), Carriage Return(\r),
              Line Separator(\u2028),Paragraph Separator(\u2029)
    ^x       xã§å§‹ã¾ã‚‹æ–‡å­—åˆ—
    x$       xã§çµ‚ã‚ã‚‹æ–‡å­—åˆ—
    x*?      0æ–‡å­—ä»¥ä¸Šã®x
    x+?      1æ–‡å­—ä»¥ä¸Šã®x
    x??      0æ–‡å­—ã¾ãŸã¯1æ–‡å­—ã®x
    x{n}?    nå€‹ã®x
    x{n,}?   nå€‹ä»¥ä¸Šã®x
    x{n,m}?  nå€‹ï½må€‹ã®x
    [\b]     ãƒãƒƒã‚¯ã‚¹ãƒšãƒ¼ã‚¹
    (?:x)    xã¨ã„ã†æ–‡å­—(å‚ç…§é™¤å¤–)
    x(?=y)   å…ˆèª­ã¿è¨€æ˜
    x(?!y)   å¦å®šå…ˆèª­ã¿è¨€æ˜
    (?<=x)y  å¾Œèª­ã¿è¨€æ˜
    (?<!x)y  å¦å®šå¾Œèª­ã¿è¨€æ˜

- KEY: reg.matching.x*?
  EXPLAIN: æœ€å¤§æœ€å°Match(*)
  BODY: |
    "<ABC><DEF>".match(/<.*>/)   //["<ABC><DEF>"]
    "<ABC><DEF>".match(/<.*?>/)  //["<ABC>"]

- KEY: reg.matching.x+?
  EXPLAIN: æœ€å¤§æœ€å°Match(+)
  BODY: |
    "<ABC><DEF>".match(/<.+>/)   //["<ABC><DEF>"]
    "<ABC><DEF>".match(/<.+?>/)  //["<ABC>"]

- KEY: reg.matching.x??
  EXPLAIN: æœ€å¤§æœ€å°Match(?)
  BODY: |
    "ABC".match(/AB?/)           //["AB"]
    "ABC".match(/AB??/)          //["A"]

- KEY: reg.matching.postfix
  EXPLAIN: å…ˆèª­ã¿è¨€æ˜
  BODY: |
    const target = 'CAT CAS CAN';

    const regexp = /(CA(?=S))/g;       //CASãŒã‚ã‚‹å ´åˆã€CAã«ãƒãƒƒãƒ
    const hit1 = target.match(regexp); //["CA"]

    const regexp = /(CA(?=X))/g;       //CAXãŒã‚ã‚‹å ´åˆã€CAã«ãƒãƒƒãƒ
    const hit2 = target.match(regexp); //null

- KEY: reg.matching.postfix.not
  EXPLAIN: å…ˆèª­ã¿è¨€æ˜(å¦å®š)
  BODY: |
    const target = 'CAT CAS';

    const regexp = /(CA(?!S))/g;       //CASãŒã‚ã‚‹å ´åˆã€CAã«ãƒãƒƒãƒã›ãš
    const hit1 = target.match(regexp); //["CA"] (CATã«ãƒãƒƒãƒ)

    const regexp = /(CA(?!X))/g;       //CAXãŒãªã„å ´åˆã€CAã«ãƒãƒƒãƒ
    const hit2 = target.match(regexp); //["CA", "CA"] (å…¨éƒ¨ã«ãƒãƒƒãƒ)

- KEY: reg.matching.prefix
  EXPLAIN: å¾Œèª­ã¿è¨€æ˜
  BODY: |
    const target = 'CAT CASE CAN CAST CAL';

    const regexp = /((?<=CA)S[^\s]*)/g;  //ç›´å‰ã®CAã«ç¶šã S[^\s] ã«ãƒãƒƒãƒ
    const hit= target.match(regexp);     // ["SE", "ST"]

- KEY: reg.matching.prefix.not
  EXPLAIN: å¾Œèª­ã¿è¨€æ˜(å¦å®š)
  BODY: |
    const target = 'CAT CASE MAST CAST RISK';

    const regexp = /((?<!CA)S[^\s]*)/g;
    const hit= target.match(regexp); // ["ST", "SK"]

- KEY: reg.specialChars
  EXPLAIN: ç‰¹æ®Šæ–‡å­—
  BODY: |
    \0     NULæ–‡å­—
    \b     å˜èªã®åŒºåˆ‡ã‚Šæ–‡å­—
    \B     \bä»¥å¤–ã®æ–‡å­—
    \cX    Ctrl-X(X ã«ã¯ A-Z ã®ã©ã‚Œã‹ã®æ–‡å­—)
    \d     åŠè§’æ•°å­—=[0-9]
    \D     \d ä»¥å¤–ã®æ–‡å­—=[^0-9]
    \f     æ”¹ãƒšãƒ¼ã‚¸(FF:Form-feed)
    \n     æ”¹è¡Œæ–‡å­—(LF:Line feed)
    \r     å¾©å¸°æ–‡å­—(CR:Carriage return)
    \s     1æ–‡å­—ã®ãƒ›ãƒ¯ã‚¤ãƒˆã‚¹ãƒšãƒ¼ã‚¹
    \S     ãƒ›ãƒ¯ã‚¤ãƒˆã‚¹ãƒšãƒ¼ã‚¹ä»¥å¤–ã®1æ–‡å­—
    \t     æ°´å¹³ã‚¿ãƒ–(HT:Horozontal tab)
    \v     å‚ç›´ã‚¿ãƒ–(VT:Vertical tab)
    \w     ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼(_)ã‚’å«ã‚€åŠè§’è‹±æ•°æ–‡å­—)=[A-Za-z0-9_]
    \W     \wä»¥å¤–ã®æ–‡å­— =[^A-Za-z0-9_]
    \n     nç•ªç›®ã® (...) ã«ãƒãƒƒãƒã—ãŸæ–‡å­—åˆ—
    \\\    \ohhh (é)8é€²æ•°ã§ hhh ã®æ–‡å­—
    \xhh   16é€²æ•°ã§ hh ã®æ–‡å­—

- KEY: reg.specialChar.b
  EXPLAIN: åŒºåˆ‡ã‚Šæ–‡å­—
  BODY: |
    "I like Java.".match(/\bJava\b/)       // ["Java"]
    "I like JavaScript.".match(/\bJava\b/) // null
    "I like JavaScript.".match(/\bJava/)   // ["Java"]

- KEY: reg.specialChars.unicode
  EXPLAIN: ç‰¹æ®Šæ–‡å­—(Unicode)
  BODY: |
    \uhhhh             UTF-16 Unicodeæ–‡å­—
    \u{hhhh}           éã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒšã‚¢é ˜åŸŸã® UTF-16 Unicodeæ–‡å­—ã€gãƒ•ãƒ©ã‚°æŒ‡å®šæ™‚ã®ã¿åˆ©ç”¨å¯èƒ½
    \u{hhhhh}          ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒšã‚¢é ˜åŸŸã® UTF-16 Unicodeæ–‡å­—ã€gãƒ•ãƒ©ã‚°æŒ‡å®šæ™‚ã®ã¿åˆ©ç”¨å¯èƒ½
    \p{property}       Binaryãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« propety ã‚’æŒã¤æ–‡å­—(è¦u:ES2018)
    \P{property}       Binaryãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« propety ã‚’æŒãŸãªã„æ–‡å­—(è¦u:ES2018)
    \p{gc=property}    General_Category ã« propety ã‚’æŒã¤æ–‡å­—(è¦u:ES2018)
    \P{gc=property}    General_Category ã« propety ã‚’æŒãŸãªã„æ–‡å­—(è¦u:ES2018)
    \p{sc=property}    Script ãŒ propety ã«ãƒãƒƒãƒã™ã‚‹æ–‡å­—(è¦u:ES2018)
    \p{sc=Hiragana}    Script ãŒ ã²ã‚‰ãŒãª ã«ãƒãƒƒãƒã™ã‚‹æ–‡å­—(è¦u:ES2018)
    \P{sc=property}    Script ãŒ propety ã«ãƒãƒƒãƒã—ãªã„æ–‡å­—(è¦u:ES2018)
    \p{scx=property}   Script_Extensions ãŒ propety ã«ãƒãƒƒãƒã™ã‚‹æ–‡å­—(è¦u:ES2018)
    \P{scx=property}   Script_Extensions ãŒ propety ã«ãƒãƒƒãƒã—ãªã„æ–‡å­—(è¦u:ES2018)

- KEY: reg.sample.postalCode
  EXPLAIN: éƒµä¾¿ç•ªå·
  BODY: |
    // éƒµä¾¿ç•ªå·(ãƒã‚¤ãƒ•ãƒ³ãªã—)
    const regexp = /^\d{7}$/
    regexp.test("1234567".trim())  // true
    regexp.test("1234567 ".trim()) // true
    regexp.test("123456".trim())   // false
    regexp.test("A123456".trim())  // false

    // éƒµä¾¿ç•ªå·(ãƒã‚¤ãƒ•ãƒ³ã‚ã‚Š)
    const regexp = /^[0-9]{3}-[0-9]{4}$/
    regexp.test("111-1111".trim())  // true
    regexp.test("111-1111 ".trim()) // true
    regexp.test("1111-111".trim())  // false
    regexp.test("11A-1111".trim())  // false

    //éƒµä¾¿ç•ªå·(ãƒã‚¤ãƒ•ãƒ³ä»»æ„)
    const regexp = /^[0-9]{3}-?[0-9]{4}$/
    regexp.test("123-4567".trim())  // true
    regexp.test("1234567".trim())   // true
    regexp.test("1234-567".trim())  // false
    regexp.test("1234A67".trim())   // false

- KEY: reg.sample.phoneNumber
  EXPLAIN: é›»è©±ç•ªå·(å›ºå®š)
  BODY: |
    //é›»è©±ç•ªå·(ãƒã‚¤ãƒ•ãƒ³ã‚ã‚Š)
    const regexp = /\d{2,4}-\d{2,4}-\d{4}/
    regexp.test("03-1234-5678".trim())   // true
    regexp.test("030-2340-5678".trim())  // true
    regexp.test("0301-240-5678".trim())  // true
    regexp.test("0301-2400-567".trim())  // false
    regexp.test("030-2340-5678 ".trim()) // true
    regexp.test("030-2 40-5678".trim())  // false

    //é›»è©±ç•ªå·(ãƒã‚¤ãƒ•ãƒ³ãªã—)
    const regexp = /^(0{1}\d{9,10})$/
    regexp.test("0312345678".trim())    // true
    regexp.test("0312345A78 ".trim())   // false
    regexp.test("03012345678 ".trim())  // true
    regexp.test("031234568".trim())     // false
    regexp.test("03-12345A78".trim())   // false

- KEY: reg.sample.phoneNumberCell
  EXPLAIN: é›»è©±ç•ªå·(æºå¸¯)
  BODY: |
    //æºå¸¯ç•ªå·(ãƒã‚¤ãƒ•ãƒ³ã‚ã‚Š)1
    const regexp = /^0[5789]0-[0-9]{4}-[0-9]{4}$/
    regexp.test("080-1234-5678".trim())   // true
    regexp.test("080-1234-5678 ".trim())  // true
    regexp.test("080-123-45678 ".trim())  // false

    //æºå¸¯ç•ªå·(ãƒã‚¤ãƒ•ãƒ³ã‚ã‚Š)2
    const regexp = /^(050|070|080|090)-\d{4}-\d{4}$/
    regexp.test("080-1234-5678".trim())   // true
    regexp.test("080-1234-5678 ".trim())  // true
    regexp.test("060-1234-5678 ".trim())  // false
